<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½ çš„å£°éŸ³ï¼Œä¹Ÿå€¼å¾—è¢«å¬è§</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'å¾®è½¯é›…é»‘', 'Microsoft YaHei', sans-serif;
            overflow-x: hidden;
            background: #f8f9fa;
        }

        /* ========== ç¬¬åé¡µæ•´ä½“å¸ƒå±€ ========== */
        .page-10 {
            min-height: 100vh;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 80px 20px;
            position: relative;
            overflow: hidden;
        }

        /* é¡µé¢æ ‡é¢˜ */
        .page10-header {
            text-align: center;
            margin-bottom: 80px;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }

        .page10-title {
            font-size: 3.5rem;
            font-weight: 700;
            color: #000000;
            margin-bottom: 40px;
            line-height: 1.4;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }

        .page10-intro {
            font-size: 1.6rem;
            line-height: 1.8;
            color: #555;
            text-align: left;
            margin-bottom: 60px;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease 0.3s;
        }

        /* ä¸»è¦å†…å®¹åŒºåŸŸ */
        .content-wrapper {
            position: relative;
            z-index: 10;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ç•™è¨€æ¿ä¸»ä½“ - å¡ç‰‡ç€‘å¸ƒæµè®¾è®¡ */
        .message-board-container {
            background: linear-gradient(145deg, #ffffff 0%, #fafbfc 100%);
            border-radius: 30px;
            box-shadow: 
                0 30px 80px rgba(0,0,0,0.08),
                0 10px 30px rgba(0,0,0,0.05),
                inset 0 1px 0 rgba(255,255,255,0.9);
            padding: 0;
            margin-bottom: 80px;
            position: relative;
            overflow: hidden;
            opacity: 0;
            transform: translateY(50px);
            transition: all 1s ease 0.6s;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .message-board-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
            background-size: 400% 100%;
            animation: gradientFlow 4s ease-in-out infinite;
        }

        @keyframes gradientFlow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* ç•™è¨€è¾“å…¥åŒºåŸŸ - ä¼˜åŒ–è¡¨å• */
        .message-input-section {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 50px 60px;
            position: relative;
            overflow: hidden;
        }

        .message-input-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="40" r="1" fill="rgba(255,255,255,0.15)"/><circle cx="40" cy="80" r="1.5" fill="rgba(255,255,255,0.1)"/></svg>');
            animation: floatDots 20s linear infinite;
        }

        @keyframes floatDots {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(-100px) translateY(-100px); }
        }

        .input-title {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 15px;
            text-align: center;
            position: relative;
            z-index: 2;
            text-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .input-subtitle {
            font-size: 1.1rem;
            text-align: center;
            margin-bottom: 40px;
            opacity: 0.9;
            position: relative;
            z-index: 2;
        }

        .input-form {
            position: relative;
            z-index: 2;
            max-width: 800px;
            margin: 0 auto;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-field {
            position: relative;
        }

        .form-field.full-width {
            grid-column: 1 / -1;
        }

        .form-input {
            width: 100%;
            padding: 18px 25px;
            border: none;
            border-radius: 15px;
            font-size: 1.1rem;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            color: #2c3e50;
            transition: all 0.3s ease;
            box-shadow: 
                0 8px 25px rgba(0,0,0,0.1),
                inset 0 1px 0 rgba(255,255,255,0.9);
        }

        .form-input:focus {
            outline: none;
            background: rgba(255,255,255,1);
            transform: translateY(-2px);
            box-shadow: 
                0 15px 35px rgba(0,0,0,0.15),
                0 0 0 3px rgba(255,255,255,0.3);
        }

        .form-input::placeholder {
            color: #95a5a6;
            font-style: italic;
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
            font-family: inherit;
        }

        .submit-button {
            display: block;
            margin: 30px auto 0;
            padding: 18px 50px;
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            color: #667eea;
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 
                0 8px 25px rgba(0,0,0,0.1),
                inset 0 1px 0 rgba(255,255,255,0.9);
            position: relative;
            overflow: hidden;
        }

        .submit-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s ease;
        }

        .submit-button:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 15px 40px rgba(0,0,0,0.15),
                inset 0 1px 0 rgba(255,255,255,0.9);
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
        }

        .submit-button:hover::before {
            left: 100%;
        }

        /* å¡ç‰‡ç€‘å¸ƒæµå±•ç¤ºåŒºåŸŸ */
        .messages-display {
            padding: 50px 40px;
        }

        .messages-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .messages-title {
            font-size: 2.2rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 20px;
            position: relative;
        }

        .filter-tabs {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .filter-tab {
            padding: 10px 20px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            background: white;
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .filter-tab.active {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .filter-tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .messages-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .message-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            position: relative;
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(30px);
            animation: cardFadeIn 0.6s ease forwards;
            border-left: 5px solid #667eea;
            overflow: hidden;
        }

        @keyframes cardFadeIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, transparent 80%, rgba(255,255,255,0.1));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .message-card:hover {
            transform: translateY(-10px) rotateY(5deg);
            box-shadow: 
                0 20px 40px rgba(0,0,0,0.1),
                0 10px 20px rgba(0,0,0,0.05);
        }

        .message-card:hover::before {
            opacity: 1;
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .medicine-name {
            font-size: 1.4rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .medicine-category {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .category-options {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 10px;
            display: none;
            z-index: 100;
            min-width: 150px;
        }

        .category-option {
            display: block;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }

        .category-option:hover {
            background: #f8f9fa;
        }

        .message-content {
            margin-bottom: 15px;
        }

        .message-detail {
            margin-bottom: 8px;
            font-size: 0.95rem;
            color: #666;
        }

        .message-detail strong {
            color: #2c3e50;
        }

        .message-story {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            font-style: italic;
            color: #555;
            border-left: 3px solid currentColor;
        }

        .message-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #f0f0f0;
        }

        .message-time {
            font-size: 0.85rem;
            color: #95a5a6;
            font-style: italic;
        }

        .hope-meter {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .hope-hearts {
            display: flex;
            gap: 2px;
        }

        .hope-heart {
            color: #e74c3c;
            font-size: 1.2rem;
            opacity: 0.3;
            transition: all 0.3s ease;
        }

        .hope-heart.filled {
            opacity: 1;
            animation: heartBeat 1s ease-in-out;
        }

        @keyframes heartBeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .empty-state {
            text-align: center;
            color: #95a5a6;
            padding: 80px 20px;
            grid-column: 1 / -1;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.6;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* ç»Ÿè®¡ä¿¡æ¯ */
        .stats-section {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border-radius: 20px;
            padding: 40px;
            margin-top: 50px;
            text-align: center;
            opacity: 0;
            transform: translateY(50px);
            transition: all 1s ease 1s;
        }

        .stats-title {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .stats-number {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #fff;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .stats-description {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        /* è¡ŒåŠ¨å‘¼ååŒºåŸŸ */
        .call-to-action-final {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            border-radius: 25px;
            padding: 50px;
            margin-top: 50px;
            text-align: center;
            position: relative;
            overflow: hidden;
            opacity: 0;
            transform: translateY(50px);
            transition: all 1s ease 1.2s;
        }

        .call-to-action-final::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="2" fill="rgba(255,255,255,0.1)"/></svg>') repeat;
            animation: sparkle 10s linear infinite;
        }

        .cta-final-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            position: relative;
            z-index: 2;
        }

        .cta-final-text {
            font-size: 1.4rem;
            line-height: 1.8;
            position: relative;
            z-index: 2;
            opacity: 0.9;
        }

        /* æ¼‚æµ®èƒŒæ™¯å…ƒç´  */
        .floating-elements {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 1;
            pointer-events: none;
        }

        .floating-element {
            position: absolute;
            opacity: 0.05;
            animation: floatUp 20s infinite linear;
            font-size: 2rem;
        }

        .floating-element:nth-child(1) { left: 10%; animation-delay: 0s; }
        .floating-element:nth-child(2) { left: 20%; animation-delay: -4s; }
        .floating-element:nth-child(3) { left: 30%; animation-delay: -8s; }
        .floating-element:nth-child(4) { left: 40%; animation-delay: -12s; }
        .floating-element:nth-child(5) { left: 50%; animation-delay: -16s; }
        .floating-element:nth-child(6) { left: 60%; animation-delay: -3s; }
        .floating-element:nth-child(7) { left: 70%; animation-delay: -7s; }
        .floating-element:nth-child(8) { left: 80%; animation-delay: -11s; }

        @keyframes floatUp {
            0% {
                transform: translateY(100vh) rotate(0deg);
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
            }
        }

        @keyframes sparkle {
            0% { transform: translateX(0) translateY(0); }
            100% { transform: translateX(-100px) translateY(-100px); }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .page10-title {
                font-size: 2.8rem;
            }
            
            .page10-intro {
                font-size: 1.4rem;
            }
            
            .message-board-container {
                margin: 20px 10px;
            }
            
            .message-input-section,
            .messages-display {
                padding: 30px 25px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .messages-grid {
                grid-template-columns: 1fr;
            }
            
            .filter-tabs {
                justify-content: flex-start;
                overflow-x: auto;
                padding-bottom: 10px;
            }
        }

        /* åŠ¨ç”»æ•ˆæœç±» */
        .fade-in-element {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }

        .fade-in-element.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* åˆ†ç±»é¢œè‰²ä¸»é¢˜ */
        .category-heart { 
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            border-color: #e74c3c;
        }
        .category-cancer { 
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            border-color: #9b59b6;
        }
        .category-diabetes { 
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border-color: #3498db;
        }
        .category-pain { 
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            border-color: #2ecc71;
        }
        .category-mental { 
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            border-color: #f39c12;
        }
        .category-rare { 
            background: linear-gradient(135deg, #e67e22, #d35400);
            color: white;
            border-color: #e67e22;
        }
        .category-other { 
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: white;
            border-color: #95a5a6;
        }
    </style>
</head>
<body>
    <!-- ç¬¬åé¡µï¼šç•™è¨€æ¿ -->
    <div class="page-10" id="page10">
        <!-- æ¼‚æµ®èƒŒæ™¯å…ƒç´  -->
        <div class="floating-elements">
            <div class="floating-element">ğŸ’Š</div>
            <div class="floating-element">ğŸ¥</div>
            <div class="floating-element">ğŸ’‰</div>
            <div class="floating-element">ğŸ©º</div>
            <div class="floating-element">â¤ï¸</div>
            <div class="floating-element">ğŸ”¬</div>
            <div class="floating-element">ğŸ’Š</div>
            <div class="floating-element">ğŸ¥</div>
        </div>

        <!-- é¡µé¢æ ‡é¢˜åŒºåŸŸ -->
        <div class="page10-header">
            <h1 class="page10-title fade-in-element">ä½ çš„å£°éŸ³ï¼Œä¹Ÿå€¼å¾—è¢«å¬è§</h1>
            <div class="page10-intro fade-in-element">
                <p>åŒ»ä¿è°ˆåˆ¤å…³ä¹æ¯ä¸€ä¸ªäººçš„å¥åº·æƒç›Šã€‚å¦‚æœä½ ä¹Ÿåœ¨å…³æ³¨æŸç§è¯ç‰©æ˜¯å¦è¿›å…¥åŒ»ä¿ï¼Œæˆ–è€…ä½ æ­£äº²å†"æœ‰è¯éš¾åŠ"çš„å›°å¢ƒï¼Œæˆ‘ä»¬æ¬¢è¿ä½ åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œå†™ä¸‹ä½ æœ€å¸Œæœ›çº³å…¥åŒ»ä¿çš„é‚£ä¸€æ¬¾è¯ã€‚</p>
            </div>
        </div>

        <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
        <div class="content-wrapper">
            <!-- ç•™è¨€æ¿ä¸»ä½“ -->
            <div class="message-board-container fade-in-element">
                <!-- ç•™è¨€è¾“å…¥åŒºåŸŸ -->
                <div class="message-input-section">
                    <h2 class="input-title">åˆ†äº«ä½ çš„æœŸå¾…</h2>
                    <p class="input-subtitle">æ¯ä¸€ä»½çœŸè¯šçš„åˆ†äº«éƒ½å¯èƒ½ç‚¹äº®ä»–äººçš„å¸Œæœ›</p>
                    <form class="input-form" id="messageForm">
                        <div class="form-row">
                            <div class="form-field">
                                <input type="text" class="form-input" id="medicineName" 
                                       placeholder="è¯å“åç§° *" required>
                            </div>
                            <div class="form-field">
                                <input type="text" class="form-input" id="userName" 
                                       placeholder="æ‚¨çš„ç§°å‘¼ï¼ˆå¯é€‰ï¼‰">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-field">
                                <input type="text" class="form-input" id="userLocation" 
                                       placeholder="æ‰€åœ¨åœ°åŒºï¼ˆå¯é€‰ï¼‰">
                            </div>
                            <div class="form-field">
                                <select class="form-input" id="urgencyLevel">
                                    <option value="">ç´§æ€¥ç¨‹åº¦ï¼ˆå¯é€‰ï¼‰</option>
                                    <option value="urgent">éå¸¸ç´§æ€¥</option>
                                    <option value="moderate">æ¯”è¾ƒç´§æ€¥</option>
                                    <option value="mild">ä¸€èˆ¬ç´§æ€¥</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-field full-width">
                            <textarea class="form-input form-textarea" id="userStory" 
                                      placeholder="åˆ†äº«æ‚¨çš„æ•…äº‹ï¼šä¸ºä»€ä¹ˆè¿™æ¬¾è¯å“å¯¹æ‚¨å¾ˆé‡è¦ï¼Ÿå®ƒèƒ½å¦‚ä½•å¸®åŠ©åˆ°æ‚¨æˆ–æ‚¨çš„å®¶äººï¼Ÿï¼ˆå¯é€‰ï¼‰"></textarea>
                        </div>
                        
                        <button type="submit" class="submit-button">
                            å‘å‡ºæˆ‘çš„å£°éŸ³
                        </button>
                    </form>
                </div>

                <!-- ç•™è¨€å±•ç¤ºåŒºåŸŸ -->
                <div class="messages-display">
                    <div class="messages-header">
                        <h3 class="messages-title">å¸Œæœ›çš„å£°éŸ³</h3>
                        <div class="filter-tabs">
                            <div class="filter-tab active" data-filter="all">å…¨éƒ¨</div>
                            <div class="filter-tab" data-filter="heart">å¿ƒè¡€ç®¡</div>
                            <div class="filter-tab" data-filter="cancer">æŠ—ç™Œ</div>
                            <div class="filter-tab" data-filter="diabetes">ç³–å°¿ç—…</div>
                            <div class="filter-tab" data-filter="pain">ç–¼ç—›</div>
                            <div class="filter-tab" data-filter="mental">ç²¾ç¥ç§‘</div>
                            <div class="filter-tab" data-filter="rare">ç½•è§ç—…</div>
                            <div class="filter-tab" data-filter="other">å…¶ä»–</div>
                        </div>
                    </div>
                    <div class="messages-grid" id="messagesContainer">
                        <div class="empty-state">
                            <div class="empty-state-icon">âœ¨</div>
                            <p>æˆä¸ºç¬¬ä¸€ä¸ªåˆ†äº«å¸Œæœ›çš„äºº</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ç»Ÿè®¡ä¿¡æ¯ -->
            <div class="stats-section fade-in-element">
                <h3 class="stats-title">å¸Œæœ›çš„æ±‡èš</h3>
                <div class="stats-number" id="messageCount">0</div>
                <div class="stats-description">æ¯ä¸ªå£°éŸ³ï¼Œæ‰¿è½½ç€æ— æ•°å®¶åº­çš„æœŸç›¼</div>
            </div>

            <!-- æœ€ç»ˆè¡ŒåŠ¨å‘¼å -->
            <div class="call-to-action-final fade-in-element">
                <h2 class="cta-final-title">è®©æˆ‘ä»¬ä¸€èµ·ï¼Œæ¨åŠ¨æ›´å¤š"ä¸å¯åŠ"æˆä¸º"å¯è´Ÿæ‹…"</h2>
                <p class="cta-final-text">
                    æ¯ä¸€ä¸ªå£°éŸ³éƒ½å¯èƒ½æˆä¸ºæ”¹å˜çš„åŠ›é‡ã€‚åŒ»ä¿è°ˆåˆ¤çš„æ¯ä¸€æ¬¡çªç ´ï¼Œéƒ½ç¦»ä¸å¼€æ‚£è€…ç¾¤ä½“çš„å…³æ³¨ä¸å‘¼å£°ã€‚
                    è®©æˆ‘ä»¬å…±åŒæœŸå¾…ï¼Œæ›´å¤šæ•‘å‘½è¯èƒ½å¤Ÿä»¥åˆç†çš„ä»·æ ¼æƒ åŠæ¯ä¸€ä¸ªéœ€è¦çš„äººã€‚
                </p>
            </div>
        </div>
    </div>

    <script>
        // è¯å“åˆ†ç±»é…ç½®
        const medicineCategories = {
            // å¿ƒè¡€ç®¡ç±»
            heart: {
                keywords: ['é˜¿å¸åŒ¹æ—', 'ç¾æ‰˜æ´›å°”', 'æ°¯æ²™å¦', 'ç¼¬æ²™å¦', 'é˜¿æ‰˜ä¼ä»–æ±€', 'ç‘èˆ’ä¼ä»–æ±€', 'ç¡è‹¯åœ°å¹³', 'æ¯”ç´¢æ´›å°”'],
                name: 'å¿ƒè¡€ç®¡',
                class: 'category-heart'
            },
            // æŠ—ç™Œç±»
            cancer: {
                keywords: ['æ›¿å°¼', 'å•æŠ—', 'æ›²å¦¥ç å•æŠ—', 'è´ä¼ç å•æŠ—', 'ä¼Šé©¬æ›¿å°¼', 'å‰éæ›¿å°¼', 'å¥¥å¸Œæ›¿å°¼', 'å¸•åšåˆ©ç å•æŠ—'],
                name: 'æŠ—ç™Œ',
                class: 'category-cancer'
            },
            // ç³–å°¿ç—…ç±»
            diabetes: {
                keywords: ['èƒ°å²›ç´ ', 'æ ¼åˆ—', 'äºŒç”²åŒèƒ', 'åˆ©æ ¼åˆ—æ±€', 'è¥¿æ ¼åˆ—æ±€', 'è¾¾æ ¼åˆ—å‡€', 'æ©æ ¼åˆ—å‡€'],
                name: 'ç³–å°¿ç—…',
                class: 'category-diabetes'
            },
            // ç–¼ç—›ç±»
            pain: {
                keywords: ['å¸ƒæ´›èŠ¬', 'å¯¹ä¹™é…°', 'åŒæ°¯èŠ¬é…¸', 'å¡æ¥æ˜”å¸ƒ', 'å—å•¡', 'èŠ¬å¤ªå°¼', 'æ›²é©¬å¤š'],
                name: 'ç–¼ç—›',
                class: 'category-pain'
            },
            // ç²¾ç¥ç§‘ç±»
            mental: {
                keywords: ['èˆæ›²æ—', 'å¸•ç½—è¥¿æ±€', 'æ–‡æ‹‰æ³•è¾›', 'å¥¥æ°®å¹³', 'åˆ©åŸ¹é…®', 'é˜¿ç«‹å“Œå”‘', 'å–¹ç¡«å¹³'],
                name: 'ç²¾ç¥ç§‘',
                class: 'category-mental'
            },
            // ç½•è§ç—…ç±»
            rare: {
                keywords: ['è¯ºè¥¿é‚£ç”Ÿé’ ', 'ä¾è¾¾æ‹‰å¥‰', 'åˆ©é²å”‘', 'é˜¿åŠ ç³–é…¶', 'ç¾é‡‘åˆš'],
                name: 'ç½•è§ç—…',
                class: 'category-rare'
            }
        };

        // ç”¨æˆ·åé¦ˆçš„åˆ†ç±»æ•°æ®
        let userCategoryFeedback = JSON.parse(localStorage.getItem('userCategoryFeedback') || '{}');

        // å­˜å‚¨ç•™è¨€çš„æ•°ç»„
        let messages = [
            {
                id: 1,
                medicineName: 'å¥¥å¸Œæ›¿å°¼',
                userName: 'å°é›¨çš„å¦ˆå¦ˆ',
                userLocation: 'ä¸Šæµ·',
                urgencyLevel: 'urgent',
                userStory: 'å¥³å„¿ç¡®è¯Šè‚ºç™ŒEGFRçªå˜ï¼Œä¸€çº¿æ²»ç–—åå‡ºç°è€è¯ã€‚åŒ»ç”Ÿè¯´å¥¥å¸Œæ›¿å°¼æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œä½†æ¯æœˆ3ä¸‡å¤šçš„è´¹ç”¨è®©æˆ‘ä»¬å®¶åº­ä¸å ªé‡è´Ÿã€‚å¸Œæœ›èƒ½æ—©æ—¥çº³å…¥åŒ»ä¿ï¼Œç»™æ›´å¤šå®¶åº­å¸¦æ¥å¸Œæœ›ã€‚',
                category: 'cancer',
                timestamp: '2024-12-15 14:30',
                hopeLevel: 5
            },
            {
                id: 2,
                medicineName: 'è¯ºè¥¿é‚£ç”Ÿé’ ',
                userName: 'åšå¼ºçš„çˆ¸çˆ¸',
                userLocation: 'åŒ—äº¬',
                urgencyLevel: 'urgent',
                userStory: 'å„¿å­æ‚£æœ‰è„Šé«“æ€§è‚Œèç¼©ç—‡ï¼Œè¿™ä¸ªè¯æ˜¯ä»–å”¯ä¸€çš„å¸Œæœ›ã€‚ä¸€é’ˆ70ä¸‡ï¼Œå¯¹æ™®é€šå®¶åº­æ¥è¯´æ˜¯å¤©æ–‡æ•°å­—ã€‚æ¯å¤©çœ‹ç€å­©å­ä¸€ç‚¹ç‚¹å¤±å»åŠ›æ°”ï¼Œæˆ‘ä»¬åªèƒ½ç¥ˆç¥·å¥‡è¿¹å‡ºç°ã€‚',
                category: 'rare',
                timestamp: '2024-12-14 09:15',
                hopeLevel: 5
            },
            {
                id: 3,
                medicineName: 'å¾·è°·èƒ°å²›ç´ ',
                userName: 'ç³–å‹å°ç‹',
                userLocation: 'æ·±åœ³',
                urgencyLevel: 'moderate',
                userStory: 'æ‚£ç³–å°¿ç—…15å¹´äº†ï¼Œç”¨è¿‡å¾ˆå¤šèƒ°å²›ç´ ï¼Œå¾·è°·èƒ°å²›ç´ æ§ç³–æ•ˆæœæœ€ç¨³å®šï¼Œä½è¡€ç³–é£é™©å°ã€‚å¸Œæœ›èƒ½çº³å…¥åŒ»ä¿ï¼Œå‡è½»é•¿æœŸç”¨è¯è´Ÿæ‹…ã€‚',
                category: 'diabetes',
                timestamp: '2024-12-13 16:45',
                hopeLevel: 4
            },
            {
                id: 4,
                medicineName: 'å¸•åšåˆ©ç å•æŠ—',
                userName: 'æŠ—ç™Œæˆ˜å£«',
                userLocation: 'å¹¿å·',
                urgencyLevel: 'urgent',
                userStory: 'é»‘è‰²ç´ ç˜¤å¤å‘è½¬ç§»ï¼ŒåŒ–ç–—æ•ˆæœä¸å¥½ã€‚PD-1æŠ‘åˆ¶å‰‚ç»™äº†æˆ‘æ–°çš„å¸Œæœ›ï¼Œä½†é«˜æ˜‚çš„è´¹ç”¨è®©æ²»ç–—å˜å¾—è‰°éš¾ã€‚æœŸå¾…åŒ»ä¿è°ˆåˆ¤èƒ½æœ‰å¥½æ¶ˆæ¯ã€‚',
                category: 'cancer',
                timestamp: '2024-12-12 11:20',
                hopeLevel: 5
            },
            {
                id: 5,
                medicineName: 'åˆ©é²å”‘',
                userName: 'æ¸å†»äººå®¶å±',
                userLocation: 'æˆéƒ½',
                urgencyLevel: 'urgent',
                userStory: 'ä¸ˆå¤«ç¡®è¯ŠALSå·²ç»ä¸¤å¹´ï¼Œåˆ©é²å”‘æ˜¯ç›®å‰å”¯ä¸€èƒ½å»¶ç¼“ç—…ç¨‹çš„è¯ç‰©ã€‚è™½ç„¶æ•ˆæœæœ‰é™ï¼Œä½†å¯¹æˆ‘ä»¬æ¥è¯´å°±æ˜¯å¸Œæœ›çš„å»¶ç»­ã€‚',
                category: 'rare',
                timestamp: '2024-12-11 20:10',
                hopeLevel: 4
            }
        ];

        // DOMå…ƒç´ 
        const messageForm = document.getElementById('messageForm');
        const messagesContainer = document.getElementById('messagesContainer');
        const messageCountElement = document.getElementById('messageCount');
        const filterTabs = document.querySelectorAll('.filter-tab');

        // å½“å‰ç­›é€‰ç±»åˆ«
        let currentFilter = 'all';

        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            displayMessages();
            updateMessageCount();
            initializeFilters();
            
            // æ»šåŠ¨åŠ¨ç”»
            const page10 = document.getElementById('page10');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const fadeElements = page10.querySelectorAll('.fade-in-element');
                        fadeElements.forEach((element, index) => {
                            setTimeout(() => {
                                element.classList.add('show');
                            }, index * 200);
                        });
                    }
                });
            }, { threshold: 0.3 });

            observer.observe(page10);
        });

        // æ™ºèƒ½åˆ†ç±»æ£€æµ‹
        function detectMedicineCategory(medicineName) {
            // é¦–å…ˆæ£€æŸ¥ç”¨æˆ·åé¦ˆæ•°æ®
            if (userCategoryFeedback[medicineName]) {
                return userCategoryFeedback[medicineName];
            }

            // å…³é”®è¯åŒ¹é…
            for (let [categoryKey, categoryData] of Object.entries(medicineCategories)) {
                for (let keyword of categoryData.keywords) {
                    if (medicineName.includes(keyword)) {
                        return categoryKey;
                    }
                }
            }

            // åŸºäºè¯å“åç§°ç‰¹å¾çš„æ™ºèƒ½æ¨æµ‹
            if (medicineName.includes('æ›¿å°¼') || medicineName.includes('å•æŠ—')) {
                return 'cancer';
            }
            if (medicineName.includes('èƒ°å²›ç´ ') || medicineName.includes('æ ¼åˆ—')) {
                return 'diabetes';
            }
            if (medicineName.includes('æ´›å°”') || medicineName.includes('æ²™å¦')) {
                return 'heart';
            }

            return 'other';
        }

        // ç”Ÿæˆå¸Œæœ›ç­‰çº§
        function generateHopeLevel(urgencyLevel, category) {
            if (urgencyLevel === 'urgent') return 5;
            if (urgencyLevel === 'moderate') return 4;
            if (urgencyLevel === 'mild') return 3;
            
            // æ ¹æ®è¯å“ç±»åˆ«è°ƒæ•´é»˜è®¤ç­‰çº§
            if (category === 'cancer' || category === 'rare') return 4;
            return 3;
        }

        // è¡¨å•æäº¤å¤„ç†
        messageForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const medicineName = document.getElementById('medicineName').value.trim();
            const userName = document.getElementById('userName').value.trim();
            const userLocation = document.getElementById('userLocation').value.trim();
            const urgencyLevel = document.getElementById('urgencyLevel').value;
            const userStory = document.getElementById('userStory').value.trim();

            if (!medicineName) {
                showNotification('è¯·è¾“å…¥è¯å“åç§°', 'error');
                return;
            }

            if (medicineName.length < 2) {
                showNotification('è¯å“åç§°è‡³å°‘éœ€è¦2ä¸ªå­—ç¬¦', 'error');
                return;
            }

            // æ£€æµ‹è¯å“åˆ†ç±»
            const category = detectMedicineCategory(medicineName);
            const hopeLevel = generateHopeLevel(urgencyLevel, category);

            // åˆ›å»ºæ–°ç•™è¨€å¯¹è±¡
            const newMessage = {
                id: Date.now(),
                medicineName: medicineName,
                userName: userName || 'åŒ¿åç”¨æˆ·',
                userLocation: userLocation,
                urgencyLevel: urgencyLevel,
                userStory: userStory,
                category: category,
                timestamp: new Date().toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                }),
                hopeLevel: hopeLevel
            };

            // æ·»åŠ åˆ°æ•°ç»„å¼€å¤´
            messages.unshift(newMessage);
            
            // é™åˆ¶æœ€å¤šæ˜¾ç¤º100æ¡ç•™è¨€
            if (messages.length > 100) {
                messages = messages.slice(0, 100);
            }

            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            localStorage.setItem('medicalMessages', JSON.stringify(messages));

            // é‡æ–°æ˜¾ç¤ºç•™è¨€
            displayMessages();
            updateMessageCount();

            // æ¸…ç©ºè¡¨å•
            messageForm.reset();

            // æç¤ºæˆåŠŸ
            showNotification('æ‚¨çš„å£°éŸ³å·²æˆåŠŸå‘å‡ºï¼æ„Ÿè°¢æ‚¨çš„åˆ†äº« âœ¨', 'success');

            // å¹³æ»‘æ»šåŠ¨åˆ°ç•™è¨€åŒºåŸŸ
            document.querySelector('.messages-display').scrollIntoView({ 
                behavior: 'smooth' 
            });
        });

        // æ˜¾ç¤ºç•™è¨€
        function displayMessages() {
            const filteredMessages = currentFilter === 'all' 
                ? messages 
                : messages.filter(msg => msg.category === currentFilter);

            if (filteredMessages.length === 0) {
                messagesContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ”</div>
                        <p>${currentFilter === 'all' ? 'è¿˜æ²¡æœ‰ç•™è¨€ï¼Œæˆä¸ºç¬¬ä¸€ä¸ªåˆ†äº«å¸Œæœ›çš„äºº' : 'æš‚æ— æ­¤ç±»åˆ«çš„ç•™è¨€'}</p>
                    </div>
                `;
                return;
            }

            messagesContainer.innerHTML = filteredMessages.map((message, index) => {
                const categoryInfo = getCategoryInfo(message.category);
                return `
                    <div class="message-card" style="animation-delay: ${index * 0.1}s; border-left-color: ${getCategoryColor(message.category)}">
                        <div class="message-header">
                            <div>
                                <div class="medicine-name">${escapeHtml(message.medicineName)}</div>
                                <div class="medicine-category ${categoryInfo.class}" 
                                     onclick="showCategoryOptions(this, '${message.medicineName}', '${message.category}')">
                                    ${categoryInfo.name}
                                    <div class="category-options">
                                        ${Object.entries(medicineCategories).map(([key, data]) => 
                                            `<div class="category-option" data-category="${key}">${data.name}</div>`
                                        ).join('')}
                                        <div class="category-option" data-category="other">å…¶ä»–</div>
                                    </div>
                                </div>
                            </div>
                            <div class="hope-meter">
                                <div class="hope-hearts">
                                    ${Array.from({length: 5}, (_, i) => 
                                        `<span class="hope-heart ${i < message.hopeLevel ? 'filled' : ''}">â™¥</span>`
                                    ).join('')}
                                </div>
                            </div>
                        </div>
                        <div class="message-content">
                            <div class="message-detail">
                                <strong>åˆ†äº«è€…ï¼š</strong>${escapeHtml(message.userName)}
                            </div>
                            ${message.userLocation ? `
                                <div class="message-detail">
                                    <strong>åœ°åŒºï¼š</strong>${escapeHtml(message.userLocation)}
                                </div>
                            ` : ''}
                            ${message.urgencyLevel ? `
                                <div class="message-detail">
                                    <strong>ç´§æ€¥ç¨‹åº¦ï¼š</strong>${getUrgencyText(message.urgencyLevel)}
                                </div>
                            ` : ''}
                            ${message.userStory ? `
                                <div class="message-story">
                                    ${escapeHtml(message.userStory)}
                                </div>
                            ` : ''}
                        </div>
                        <div class="message-footer">
                            <div class="message-time">${message.timestamp}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // è·å–åˆ†ç±»ä¿¡æ¯
        function getCategoryInfo(category) {
            if (medicineCategories[category]) {
                return {
                    name: medicineCategories[category].name,
                    class: medicineCategories[category].class
                };
            }
            return { name: 'å…¶ä»–', class: 'category-other' };
        }

        // è·å–åˆ†ç±»é¢œè‰²
        function getCategoryColor(category) {
            const colorMap = {
                heart: '#e74c3c',
                cancer: '#9b59b6',
                diabetes: '#3498db',
                pain: '#2ecc71',
                mental: '#f39c12',
                rare: '#e67e22',
                other: '#95a5a6'
            };
            return colorMap[category] || colorMap.other;
        }

        // è·å–ç´§æ€¥ç¨‹åº¦æ–‡æœ¬
        function getUrgencyText(urgencyLevel) {
            const urgencyMap = {
                urgent: 'éå¸¸ç´§æ€¥',
                moderate: 'æ¯”è¾ƒç´§æ€¥',
                mild: 'ä¸€èˆ¬ç´§æ€¥'
            };
            return urgencyMap[urgencyLevel] || '';
        }

        // æ˜¾ç¤ºåˆ†ç±»é€‰é¡¹
        function showCategoryOptions(element, medicineName, currentCategory) {
            // å…³é—­å…¶ä»–æ‰“å¼€çš„é€‰é¡¹
            document.querySelectorAll('.category-options').forEach(el => {
                if (el !== element.querySelector('.category-options')) {
                    el.style.display = 'none';
                }
            });

            const options = element.querySelector('.category-options');
            options.style.display = options.style.display === 'block' ? 'none' : 'block';

            // ä¸ºé€‰é¡¹æ·»åŠ ç‚¹å‡»äº‹ä»¶
            options.querySelectorAll('.category-option').forEach(option => {
                option.onclick = (e) => {
                    e.stopPropagation();
                    const newCategory = option.dataset.category;
                    
                    if (newCategory !== currentCategory) {
                        updateMedicineCategory(medicineName, newCategory);
                        options.style.display = 'none';
                        showNotification('æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼åˆ†ç±»å·²æ›´æ–°', 'success');
                    }
                };
            });
        }

        // æ›´æ–°è¯å“åˆ†ç±»
        function updateMedicineCategory(medicineName, newCategory) {
            // ä¿å­˜ç”¨æˆ·åé¦ˆ
            userCategoryFeedback[medicineName] = newCategory;
            localStorage.setItem('userCategoryFeedback', JSON.stringify(userCategoryFeedback));

            // æ›´æ–°æ‰€æœ‰ç›¸å…³ç•™è¨€çš„åˆ†ç±»
            messages.forEach(message => {
                if (message.medicineName === medicineName) {
                    message.category = newCategory;
                }
            });

            // ä¿å­˜æ›´æ–°åçš„ç•™è¨€
            localStorage.setItem('medicalMessages', JSON.stringify(messages));

            // é‡æ–°æ˜¾ç¤ºç•™è¨€
            displayMessages();
        }

        // åˆå§‹åŒ–ç­›é€‰å™¨
        function initializeFilters() {
            filterTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // æ›´æ–°æ´»è·ƒçŠ¶æ€
                    filterTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');

                    // æ›´æ–°ç­›é€‰æ¡ä»¶
                    currentFilter = tab.dataset.filter;
                    displayMessages();
                });
            });
        }

        // æ›´æ–°ç•™è¨€æ•°é‡
        function updateMessageCount() {
            messageCountElement.textContent = messages.length;
        }

        // HTMLè½¬ä¹‰ï¼Œé˜²æ­¢XSS
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const colors = {
                success: 'linear-gradient(135deg, #2ecc71, #27ae60)',
                error: 'linear-gradient(135deg, #e74c3c, #c0392b)',
                info: 'linear-gradient(135deg, #3498db, #2980b9)'
            };

            notification.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: ${colors[type]};
                color: white;
                padding: 20px 40px;
                border-radius: 15px;
                font-size: 1.1rem;
                font-weight: 600;
                box-shadow: 0 15px 35px rgba(0,0,0,0.2);
                z-index: 10000;
                animation: notificationSlide 0.5s ease;
                max-width: 400px;
                text-align: center;
            `;
            notification.textContent = message;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'notificationSlide 0.5s ease reverse';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 500);
            }, 3000);
        }

        // æ·»åŠ åŠ¨ç”»æ ·å¼
        const style = document.createElement('style');
        style.textContent = `
            @keyframes notificationSlide {
                from {
                    opacity: 0;
                    transform: translate(-50%, -50%) scale(0.8);
                }
                to {
                    opacity: 1;
                    transform: translate(-50%, -50%) scale(1);
                }
            }
        `;
        document.head.appendChild(style);

        // ç‚¹å‡»å¤–éƒ¨å…³é—­åˆ†ç±»é€‰é¡¹
        document.addEventListener('click', () => {
            document.querySelectorAll('.category-options').forEach(el => {
                el.style.display = 'none';
            });
        });

        // æ¸…é™¤æ‰€æœ‰ç•™è¨€çš„è°ƒè¯•å‡½æ•°
        function clearAllMessages() {
            if (confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰ç•™è¨€å—ï¼Ÿ')) {
                messages.length = 0;
                localStorage.removeItem('medicalMessages');
                displayMessages();
                updateMessageCount();
                showNotification('æ‰€æœ‰ç•™è¨€å·²æ¸…é™¤', 'info');
            }
        }

        // å¯¼å‡ºæ•°æ®å‡½æ•°
        function exportData() {
            const data = {
                messages: messages,
                userFeedback: userCategoryFeedback,
                exportTime: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `medical_messages_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // æš´éœ²è°ƒè¯•å‡½æ•°
        window.clearAllMessages = clearAllMessages;
        window.exportData = exportData;
        window.debugMessageBoard = function() {
            console.log('=== ç•™è¨€æ¿è°ƒè¯•ä¿¡æ¯ ===');
            console.log('- å½“å‰ç•™è¨€æ•°é‡:', messages.length);
            console.log('- ç”¨æˆ·åˆ†ç±»åé¦ˆ:', userCategoryFeedback);
            console.log('- å½“å‰ç­›é€‰:', currentFilter);
            console.log('- åˆ†ç±»ç»Ÿè®¡:', getCategoryStats());
        };

        // è·å–åˆ†ç±»ç»Ÿè®¡
        function getCategoryStats() {
            const stats = {};
            messages.forEach(msg => {
                stats[msg.category] = (stats[msg.category] || 0) + 1;
            });
            return stats;
        }
    </script>
</body>
</html>