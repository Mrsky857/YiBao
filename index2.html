<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>医保谈判的七年：救命药真的便宜了吗？</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: '微软雅黑', 'Microsoft YaHei', sans-serif;
            overflow-x: hidden;
        }

        /* ========== 第一页 - 封面页 ========== */
        .page-1 {
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), 
                        url('cover.jpg');
            background-size: cover;
            background-position: center;
            color: white;
            transition: transform 1.2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .title {
            font-size: 4rem;
            font-weight: bold;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
            opacity: 0;
            transform: translateY(50px);
            animation: fadeInUp 1s ease-out 0.5s forwards;
        }

        .subtitle {
            font-size: 2rem;
            opacity: 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
            animation: fadeInUp2 1s ease-out 1s forwards;
            text-align: center;
            width: 100%;
        }

        .scroll-hint {
            position: absolute;
            bottom: 50px;
            width: 100%;
            color: white;
            font-size: 1.2rem;
            opacity: 0;
            animation: fadeInUp3 1s ease-out 2s forwards;
            text-align: center;
        }

        .scroll-text {
            display: block;
            margin-bottom: 10px;
        }

        .scroll-arrow {
            display: block;
            font-size: 2rem;
            animation: bounce 2s infinite 3s;
        }

        /* ========== 第二页 - 谈判现场语录 ========== */
        .page-2 {
            min-height: 200vh;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            padding: 100px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
            margin-top: 100vh;
        }

        .quotes-container {
            position: relative;
            width: 100%;
            min-height: 0vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            padding-top: 100px;
            gap: 40px;
        }

        .quote-bubble {
            background: rgba(255,255,255,0.95);
            padding: 30px 40px;
            border-radius: 25px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            max-width: 700px;
            width: 90%;
            font-size: 1.6rem;
            font-weight: bold;
            color: #000000;
            text-align: center;
            opacity: 0;
            transform: scale(0.8) translateY(30px);
            transition: all 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            position: relative;
            margin-bottom: 20px;
        }

        .quote-bubble.show {
            opacity: 1;
            transform: scale(1) translateY(0);
        }

        .quote-bubble.price {
            color: #000000;
            font-size: 1.8rem;
        }

        .scene-description {
            margin-top: 100px;
            max-width: 800px;
            text-align: center;
            color: white;
            padding: 40px 20px;
        }

        .scene-text {
            font-size: 1.5rem;
            line-height: 2;
            margin-bottom: 15px;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }

        .scene-text.show {
            opacity: 1;
            transform: translateY(0);
        }

        .scene-text.highlight {
            color: #f39c12;
            font-weight: bold;
            background: none;
        }

        /* ========== 第三页 - 国谈药定义 ========== */
        .page-3 {
    min-height: 100vh;
    background: #ecf0f1;
    /* 去掉原来的上下 padding */
    padding: 0 20px;
    /* Flex 布局：垂直＋水平都居中 */
    display: flex;
    flex-direction: column;
    justify-content: center;  /* 垂直居中 */
    align-items: center;      /* 水平居中 */
}
.page-2-5 {
  min-height: 100vh;
  background: linear-gradient(135deg, #ecf0f1 0%, #e3e7e9f8 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
}

.page-2-5 .transition-content {
  /* 确保子元素可以被 text-align 影响 */
  text-align: center;
}

.page-2-5 .transition-title {
  display: inline-block;   /* 从 block 切换到 inline-block */
  width: auto;             /* 不要再占满 100% 宽度，改为根据文本自适应 */
  white-space: nowrap;     /* 保持不换行 */
  margin: 0 auto 40px;     /* 上 0，左右 auto（水平居中），下 40px */
  font-size: 2.8rem;
  line-height: 1.4;
  color: #000;
  font-weight: 600;
}

.page-2-5 .final-text {
  font-size: 2.8rem;
  color: #000;
  font-weight: 600;
  margin: 20px 0 30px;
}

.page-2-5 .medicine-box-container {
  position: relative;
  z-index: 2;
  margin-top: 30px;
}

.page-2-5 .medicine-box-img {
  width: 100%;
  max-width: 600px;
  height: auto;
  display: block;
  margin: 0 auto;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.1);
}

/* 确保粒子在图片下方 */
.page-2-5 .extra-particle {
  width: 12px !important;
  height: 12px !important;
}

/* 保留粒子动画 */
@keyframes extraParticle {
  0% {
    opacity: 1;
    transform: translateY(0) scale(0.5);
  }
  100% {
    opacity: 0;
    transform: translateY(-300px) scale(2);
  }
}

/* ================= 响应式设计 ================= */
@media (max-width: 768px) {
    .transition-title {
        font-size: 2.2rem;
    }
    
    .final-text {
        font-size: 2.2rem;
    }
    
    .keyword {
        font-size: 2.8rem;
    }
    
    .medicine-box-img {
        max-width: 320px;
        width: 90%;
    }
    
    .medicine-box-container::before {
        left: 15%;
        top: 15%;
    }
    
    .medicine-box-container::after {
        right: 20%;
        top: 25%;
    }
}

@media (max-width: 480px) {
    .transition-title {
        font-size: 1.8rem;
    }
    
    .final-text {
        font-size: 1.8rem;
    }
    
    .keyword {
        font-size: 2.4rem;
    }
}
/* 修改第三页样式 - 去掉标题的margin */
.page-3 {
    min-height: 100vh;
    background: #ecf0f1;
    padding: 80px 20px; /* 减少上边距 */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

/* 响应式调整 */
@media (max-width: 768px) {
    .transition-title {
        font-size: 2.5rem;
    }
    
    .text-key {
        font-size: 3rem;
    }
    
    .concept-illustration {
        max-width: 350px;
    }
}
        .page-3 .section-title {
            font-size: 3.2rem;
            color: #000000;
            margin-bottom: 50px;
            text-align: center;
            line-height: 1.6;
            opacity: 0;
            transform: translateY(30px);
        }

        .definition-content h3 {
            font-size: 2.8rem;
            color: #000000;
            margin-bottom: 20px;
        }

        .definition-content p {
            font-size: 1.8rem;
            line-height: 1.8;
            color: #555;
            margin-bottom: 15px;
        }

        .page-3 .definition-card {
    background: white;
    border-radius: 20px;
    padding: 60px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    max-width: 1000px;
    /* 垂直初始位置保留动画用 translateY(30px) */
    opacity: 0;
    transform: translateY(30px);

    /* 保证水平自动居中（对于非 flex 场景也生效） */
    margin: 0 auto;
    width: 100%;
}

        .highlight-text {
            color: #f39c12;
            font-weight: bold;
            margin: 15px 0;
            display: block;
            background: none;
        }

        .highlight {
            color: #f39c12;
            font-weight: bold;
            background: none;
        }

        /* ========== 第四页 - 逐个展示药品 ========== */
        .page-4 {
            min-height: 300vh;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 100px 20px;
            position: relative;
            overflow: hidden;
        }

        .page-4 .section-title {
            position: fixed;
            top: 10%;
            left: 0;
            right: 0;
            margin: 0 auto 60px;
            text-align: center;

            font-size: 3.2rem;
            color: #000000;
            opacity: 0;
            transition: opacity 0.8s ease;
            white-space: nowrap;
            z-index: 100;
        }

        .page-4 .section-title.show {
            opacity: 1;
        }


        /* 第四页的固定容器 - 重要：添加条件显示 */
        .page-4 .sticky-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
            pointer-events: none; /* 默认不接收鼠标事件 */
        }

        /* 只有在第四页范围内才显示并接收事件 */
        .page-4 .sticky-container.in-view {
            pointer-events: auto;
        }

        .drug-card {
            position: absolute;
            display: flex;
            align-items: center;
            gap: 60px;
            max-width: 1200px;
            width: 90%;
            opacity: 0;
            transform: translateY(100px);
            transition: all 1s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .drug-card.active {
            opacity: 1;
            transform: translateY(0);
        }

        .drug-card.exit-up {
            opacity: 0;
            transform: translateY(-100px);
        }

        .drug-avatar {
            background: white;
            padding: 30px;
            border-radius: 50%;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            min-width: 350px;
            min-height: 350px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .drug-avatar img {
            width: 320px;
            height: 320px;
            object-fit: contain;
            border-radius: 50%;
            pointer-events: none; /* 图片不接收鼠标事件 */
        }

        .drug-content {
            background: rgba(255,255,255,0.95);
            padding: 50px 60px;
            border-radius: 25px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            flex: 1;
            position: relative;
        }

        .drug-content::before {
            content: '';
            position: absolute;
            top: 50%;
            left: -15px;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-top: 15px solid transparent;
            border-bottom: 15px solid transparent;
            border-right: 15px solid rgba(255,255,255,0.95);
        }

        .drug-content p {
            margin-bottom: 20px;
            line-height: 1.8;
            color: #000000;
            font-size: 1.4rem;
        }

        .drug-content .highlight {
            background: linear-gradient(120deg, #e74c3c, #c0392b);
            color: white;
            padding: 3px 8px;
            border-radius: 5px;
            font-weight: bold;
        }

        /* ========== 第五页 - 流程图 ========== */
        .page-5 {
            min-height: 100vh;
            background: linear-gradient(135deg, #ecf0f1 0%, #ecf0f1 100%);
            padding: 100px 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative; /* 重要：确保创建新的层叠上下文 */
            z-index: 10; /* 确保第五页在第四页之上 */
        }
        /* 第5页新增样式 */
        .page-5 .white-text {
        color: rgb(0, 0, 0);
        }

        .page-5 .page5-title {
        color:  #000000;;        /* 标题可以用红色或你想要的色 */
        font-size: 3.2rem;
        font-weight: 700;
        text-align: center;
        margin: 40px 0;
        line-height: 1.4;
        }

        /* 引导文字样式 */
        .page-5 .intro-text {
            color: #000000;
            font-size: 2.0rem;
            line-height: 2;
            margin-bottom: 30px;
            text-align: center;
            max-width: 800px;
        }

        .page-5 .intro-highlight {
            color: #3498db;
            font-weight: bold;
        }

        .page-5 .intro-question {
            color: #e74c3c;
            font-size: 1.6rem;
            font-weight: bold;
            margin: 40px 0;
            text-align: center;
        }

        /* 流程图容器 */
        .page-5 .roadmap-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            padding: 50px;
            max-width: 1200px;
            width: 100%;
            position: relative;
            z-index: 1; /* 基础层级 */
        }

        .page-5 .header {
            text-align: center;
            margin-bottom: 60px;
            position: relative;
            z-index: 2;
        }

        .page-5 .main-title {
            font-size: 52px;
            font-weight: 900;
            background: linear-gradient(135deg, #000000, #000000, #000000);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 3px;
            margin-bottom: 15px;
        }

        /* 路径容器 - 关键修改 */
        .page-5 .roadmap-path {
            position: relative;
            width: 100%;
            height: 600px;
            margin-bottom: 40px;
            pointer-events: none; /* 整个容器不接收事件 */
        }

        /* SVG路径 - 确保不阻挡点击 */
        .page-5 .path-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0; /* 最底层 */
            pointer-events: none; /* 不接收任何鼠标事件 */
        }

        /* 所有SVG内的元素都不接收事件 */
        .page-5 .path-svg * {
            pointer-events: none !important;
        }

        /* 步骤节点 - 最关键的部分 */
        .page-5 .step-node {
            position: absolute;
            z-index: 100; /* 高层级确保可点击 */
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: auto !important; /* 强制可点击 */
        }

        .page-5 .step-node:hover {
            transform: scale(1.1);
            z-index: 110; /* hover时更高层级 */
        }

        .page-5 .node-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF8C00, #FFA500);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 25px rgba(255, 140, 0, 0.4);
            position: relative;
            animation: nodeAppear 0.6s ease-out forwards;
            opacity: 0;
            transform: scale(0);
            pointer-events: auto !important; /* 确保圆圈可点击 */
        }

        .page-5 .node-number {
            font-size: 24px;
            font-weight: 900;
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
            z-index: 2;
            position: relative;
            pointer-events: none; /* 数字不接收事件，让事件传递到父元素 */
        }

        .page-5 .step-label {
            background: rgba(44, 82, 130, 0.95);
            color: white;
            padding: 16px 28px;
            border-radius: 22px;
            font-size: 20px;
            font-weight: 600;
            margin-top: 25px;
            box-shadow: 0 5px 15px rgba(44, 82, 130, 0.3);
            text-align: center;
            min-width: 140px;
            pointer-events: none; /* 标签不接收事件 */
        }

        /* 节点位置 */
        .page-5 .step-1 { top: 80px; left: 80px; }
        .page-5 .step-2 { top: 280px; left: 280px; }
        .page-5 .step-3 { top: 120px; left: 520px; }
        .page-5 .step-4 { top: 320px; left: 760px; }
        .page-5 .step-5 { top: 80px; left: 1000px; }

        /* 详情面板 */
        .page-5 .details-panel {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 25px;
            padding: 30px;
            margin-top: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(20px);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            max-height: 0;
            overflow: hidden;
        }

        .page-5 .details-panel.active {
            opacity: 1;
            transform: translateY(0);
            max-height: 300px;
        }

        /* 确保所有可能遮挡的元素都不影响点击 */
        .page-5 img,
        .page-5 svg,
        .page-5 path,
        .page-5 .path-line,
        .page-5 .path-shadow,
        .page-5 .path-highlight {
            pointer-events: none !important;
        }

        /* 通用动画和效果 */
        .fade-in-element {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }

        .fade-in-element.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* 动画定义 */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp2 {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp3 {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        @keyframes drawPath {
            to { stroke-dashoffset: 0; }
        }

        @keyframes flowDirection {
            0% { stroke-dashoffset: 30; }
            100% { stroke-dashoffset: 0; }
        }

        @keyframes nodeAppear {
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes ripple {
            0% { transform: scale(1.2); opacity: 0.6; }
            100% { transform: scale(1.8); opacity: 0; }
        }

        /* 节点动画延迟 */
        .page-5 .step-1 .node-circle { animation-delay: 0.8s; }
        .page-5 .step-2 .node-circle { animation-delay: 1.6s; }
        .page-5 .step-3 .node-circle { animation-delay: 2.4s; }
        .page-5 .step-4 .node-circle { animation-delay: 3.2s; }
        .page-5 .step-5 .node-circle { animation-delay: 4.0s; }

        /* 节点波纹效果 */
        .page-5 .node-circle::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: linear-gradient(135deg, #FF8C00, #FFA500);
            opacity: 0.6;
            transform: scale(1.2);
            animation: ripple 2s infinite;
            pointer-events: none; /* 波纹不接收事件 */
        }

        /* SVG路径样式 */
        .page-5 .path-line {
            fill: none;
            stroke: url(#pathGradient);
            stroke-width: 25;
            stroke-linecap: round;
            stroke-linejoin: round;
            filter: drop-shadow(0 8px 20px rgba(74, 144, 226, 0.4));
            stroke-dasharray: 3000;
            stroke-dashoffset: 3000;
            animation: drawPath 4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }

        .page-5 .path-shadow {
            fill: none;
            stroke: rgba(74, 144, 226, 0.15);
            stroke-width: 35;
            stroke-linecap: round;
            stroke-linejoin: round;
            filter: blur(15px);
        }

        .page-5 .path-highlight {
            fill: none;
            stroke: url(#pathHighlight);
            stroke-width: 8;
            stroke-linecap: round;
            stroke-linejoin: round;
            opacity: 0.8;
            stroke-dasharray: 20 10;
            animation: flowDirection 3s linear infinite;
        }

        /* 详情面板样式 */
        .page-5 .details-title {
            font-size: 28px;
            font-weight: 800;
            color: #2C5282;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .page-5 .details-time {
            background: linear-gradient(135deg, #FF8C00, #FFA500);
            color: white;
            padding: 8px 16px;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 700;
            margin-left: 15px;
        }

        .page-5 .details-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .page-5 .detail-item {
            background: rgba(74, 144, 226, 0.1);
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid #4A90E2;
            transition: all 0.3s ease;
        }

        .page-5 .detail-item:hover {
            transform: translateX(5px);
            background: rgba(74, 144, 226, 0.15);
        }

        .page-5 .detail-item h4 {
            color: #2C5282;
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        .page-5 .details-panel {
        pointer-events: auto;
        z-index: 200;
        }

        .page-5 .step-label {
        pointer-events: auto;
        }

        .page-5 .detail-item p {
            color: #4A5568;
            font-size: 14px;
            line-height: 1.5;
        }
        .page-5 .roadmap-container {
  position: relative; /* 确保定位参照 */
}

.page-5 .roadmap-container .click-tip {
  position: absolute;
  left: 50%;                    /* 水平居中 */
  bottom: 30px;                 /* 距底部稍微往上 */
  transform: translateX(-50%);  /* 通过偏移实现精确居中 */
  
  background: rgba(44, 82, 130, 0.95);
  color: #fff;
  
  font-size: 1.4rem;            /* 放大字体 */
  padding: 12px 20px;           /* 增大内边距 */
  border-radius: 6px;
  
  cursor: pointer;
  opacity: 0.8;
  transition: opacity 0.3s ease, transform 0.3s ease;
  user-select: none;
  white-space: nowrap;
}

.page-5 .roadmap-container .click-tip:hover {
  opacity: 1;
  transform: translateX(-50%) translateY(-2px);
}

        /* 响应式设计 */
        @media (max-width: 768px) {
    .title { font-size: 2.5rem; }
    .subtitle { font-size: 1.3rem; }
    
    .page-5 .roadmap-container { padding: 30px 20px; }
    .page-5 .main-title { font-size: 36px; }
    .page-5 .roadmap-path { height: 800px; }
    
    /* 移动端节点位置调整 */
    .page-5 .step-1 { top: 80px; left: 50px; }
    .page-5 .step-2 { top: 200px; left: 50px; }
    .page-5 .step-3 { top: 320px; left: 50px; }
    .page-5 .step-4 { top: 440px; left: 50px; }
    .page-5 .step-5 { top: 560px; left: 50px; }
    
    /* 移动端隐藏SVG路径 */
    .page-5 .roadmap-path svg { display: none; }
    
    /* 移动端显示垂直线 */
    .page-5 .roadmap-path::before {
        content: '';
        position: absolute;
        left: 90px;
        top: 120px;
        bottom: 200px;
        width: 4px;
        background: linear-gradient(180deg, #4A90E2, #67B7DC, #89CDF1, #67B7DC, #2C5282);
        border-radius: 2px;
    }
}

/* ================= 第六页样式 - 修复后放在正确位置 ================= */
    .page-6 {
        min-height: 100vh;
        padding: 80px 20px;
        background: #f8f9fa;
        box-sizing: border-box;
    }

    /* 文本区 */
    .page-6 .text-section {
        max-width: 800px;
        margin: 0 auto 40px;
        line-height: 1.8;
        color: #333;
        font-size: 1.8rem;
    }

    /* 大标题（第一行） */
    .page-6 .text-section > h2 {
        font-size: 2.6rem;
        font-weight: 600;
        margin-bottom: 16px;
        color: hwb(0 0% 100%);
        text-align: center;
    }

    /* 副标题（如果有的话） */
    .page-6 .text-section > h3 {
        font-size: 1.8rem;
        font-weight: 500;
        margin: 24px 0 16px;
        color: #000000;
        text-align: center;
    }

    /* 正文段落 */
    .page-6 .text-section > p {
        margin-bottom: 16px;
        text-align: center;  /* 所有段落文字居中 */
    }

    /* 高亮数字本身 */
    .page-6 .text-section .highlight-number {
        color: #e67e22;       /* 橙黄色 */
        font-weight: 700;     /* 加粗高亮文字 */
    }

    /* 页眉样式 */
    .page-6 .header {
        text-align: center;
        margin-bottom: 30px;
    }

    .page-6 .header .main-title {
        font-size: 2rem;
        font-weight: 700;
        color: #000000;
        margin-bottom: 8px;
    }

    .page-6 .header .subtitle {
        font-size: 1rem;
        color: #666;
    }
    /* 第六页文字动画样式 */
    .page6-text {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.8s ease;
        margin-bottom: 16px;
        text-align: center;
        font-size: 1.8rem;
        line-height: 1.8;
        color: #333;
    }

    .page6-text.show {
        opacity: 1;
        transform: translateY(0);
    }

    /* 高亮数字的特殊动画 */
    .page6-text.show .highlight-number {
        animation: highlightGlow 1.5s ease-out;
    }

    @keyframes highlightGlow {
        0% { 
            transform: scale(1);
            filter: brightness(1);
        }
        50% { 
            transform: scale(1.1);
            filter: brightness(1.3);
        }
        100% { 
            transform: scale(1);
            filter: brightness(1);
        }
    }

    /* 标题特殊样式 */
   
    .page-6 .text-section > h2.page6-text {
    font-size: 2.6rem;      /* 你原来的大小 */
    font-weight: 600;       /* 加粗 */
    color: #000;            /* 你原来的颜色 */
    margin-bottom: 30px;    /* 你原来的间距 */
}

/* —— 让所有正文段落恢复常规字重 —— */
.page-6 .text-section > p.page6-text {
    font-weight: normal !important;
}
    /* —— 缩小第六页图表和统计面板之间的间距 —— */

        /* ---- 图表容器 ---- */
        .page-6 .chart-container {
        width: 100%;
        max-width: 1200px;
        height: 500px;
        margin: 0 auto 0px;
        position: relative;
        }

        /* ---- 统计面板 ---- */
        .page-6 .stats-panel {
        max-width: 1200px;
        margin: 0 auto;
        }

        .page-6 .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        }

        .page-6 .stat-item {
        background: #fff;
        padding: 20px;
        border-radius: 8px;
        text-align: center;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }

        .page-6 .stat-item .stat-number {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 4px;
        }

        .page-6 .stat-item:nth-child(1) .stat-number {
        color: #afd3e7;
        }

        .page-6 .stat-item:nth-child(2) .stat-number {
        color: #fca3a3;
        }

        .page-6 .stat-item:nth-child(3) .stat-number {
        color: #fdcd8c;
        }

        .page-6 .stat-item:nth-child(4) .stat-number {
        color: #d0bbdb;
        }

        .page-6 .stat-item .stat-label {
        font-size: 0.9rem;
        color: #555;
        }

       /* ================= 第七页样式 ================= */
        .page-7 {
            min-height: 100vh;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 80px 20px;
            position: relative;
            overflow: hidden;
        }

        /* 标题和导语样式 */
        .page7-header {
            text-align: center;
            margin-bottom: 60px;
        }

        .page7-title {
            font-size: 3.2rem;
            font-weight: 700;
            color: #000000;
            margin-bottom: 30px;
            line-height: 1.4;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease;
        }

        .page7-intro {
            max-width: 800px;
            margin: 0 auto;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease 0.2s;
        }

        .page7-intro p {
            font-size: 1.6rem;
            line-height: 1.8;
            color: #555;
            margin-bottom: 10px;
        }

        /* 扑克牌容器 */
        .poker-cards-container {
            display: grid;
  grid-template-columns: repeat(4, minmax(280px, 1fr)); /* 固定 4 列 */
  gap: 30px;
            padding: 0 20px;
            max-width: 1200px;
            margin: 0 auto 80px;
            padding: 0 20px;
        }

        /* 扑克牌基础样式 */
        .poker-card {
            perspective: 1000px;
            height: 400px;
            cursor: pointer;
            transform: translateY(50px);
            transition: all 0.6s ease;
        }

        .poker-card:nth-child(1) { transition-delay: 0.1s; }
        .poker-card:nth-child(2) { transition-delay: 0.2s; }
        .poker-card:nth-child(3) { transition-delay: 0.3s; }
        .poker-card:nth-child(4) { transition-delay: 0.4s; }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s;
            transform-style: preserve-3d;
        }

        .poker-card:hover .card-inner {
            transform: rotateY(180deg);
        }

        /* 卡片正反面 */
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 30px;
        }

        .card-front {
            background: white;
            border: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .card-back {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            transform: rotateY(180deg);
        }

        /* 根据类别设置边框颜色 */
        .poker-card[data-category="cancer"] .card-front {
            border-color: #ed5f5f;
        }

        .poker-card[data-category="chronic"] .card-front {
            border-color: #ffa74f;
        }

        .poker-card[data-category="rare"] .card-front {
            border-color: #53a8e1;
        }

        .poker-card[data-category="other"] .card-front {
            border-color: #9a72c7;
        }

        /* 悬停效果 */
        .poker-card:hover .card-front {
            transform: translateZ(10px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        /* 卡片图标 */
        .card-icon {
            width: 100px;
            height: 100px;
            margin-bottom: 20px;
        }

        .card-icon svg {
            width: 100%;
            height: 100%;
        }

        /* 卡片内容 */
        .card-title {
            font-size: 1.6rem;
            font-weight: 600;
            color: #000000;
            margin-bottom: 20px;
        }

        .card-number {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .poker-card[data-category="cancer"] .card-number { color: #ed5f5f; }
        .poker-card[data-category="chronic"] .card-number { color: #ffa74f; }
        .poker-card[data-category="rare"] .card-number { color: #53a8e1; }
        .poker-card[data-category="other"] .card-number { color: #9a72c7; }

        .card-desc {
            font-size: 1.2rem;
            color: #666;
        }

        /* 卡片背面样式 */
        .card-back h4 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #f39c12;
        }

        .card-back p {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        /* 统计数据段落样式 */
        .statistics-section {
            max-width: 1000px;
            margin: 0 auto 60px;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease 0.5s;
        }

        .stat-paragraph {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            display: flex;
            align-items: flex-start;
            gap: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-paragraph::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            transition: width 0.3s ease;
        }

        .stat-paragraph[data-category="cancer"]::before { background: #ed5f5f; }
        .stat-paragraph[data-category="chronic"]::before { background: #ffa74f; }
        .stat-paragraph[data-category="rare"]::before { background: #53a8e1; }
        .stat-paragraph[data-category="other"]::before { background: #9a72c7; }

        .stat-paragraph:hover {
            transform: translateX(10px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .stat-paragraph:hover::before {
            width: 8px;
        }

        .stat-icon {
            font-size: 2rem;
            flex-shrink: 0;
        }

        .stat-paragraph p {
            font-size: 1.4rem;
            line-height: 1.8;
            color: #444;
            margin: 0;
        }

        .highlight-stat {
            color: #e74c3c;
            font-weight: 600;
            background: linear-gradient(120deg, #fff5f5, #ffe0e0);
            padding: 2px 6px;
            border-radius: 4px;
        }

        /* 气泡图容器 */
        .bubble-chart-container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-width: 1200px;
            margin: 0 auto 60px;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease 0.6s;
        }

        .chart-title {
            font-size: 2rem;
            font-weight: 600;
            color: #000000;
            text-align: center;
            margin-bottom: 30px;
        }

        /* 结尾总结 */
        .page7-conclusion {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0.8));
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.8s ease 0.7s;
        }

        .page7-conclusion p {
            font-size: 1.6rem;
            line-height: 2;
            color: #333;
        }

        .highlight-conclusion {
            color: #000000;
            font-weight: 700;
            background: linear-gradient(120deg, #f39c12, #e67e22);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* 动画效果类 */
        .page-7 .fade-in-element.show {
            opacity: 1;
            transform: translateY(0);
        }
        /* ========== 第八页整体布局 ========= */
.page-8 {
    background: #f0f2f5;
    padding: 60px 20px;
    min-height: 300vh;
    box-sizing: border-box;
}
/* 标题 */
.page8-title {
    font-size: 3.2rem; font-weight:700; color:#000;
    text-align:center; margin-bottom:20px;
    opacity:0; transform:translateY(30px);
    transition:all 0.8s ease;
}
.page8-title.show { opacity:1; transform:translateY(0); }
/* 副标题 */
.page8-subtitle {
    font-size:1.8rem; color:#666; text-align:center;
    margin-bottom:100px; opacity:0; transform:translateY(30px);
    transition:all 0.8s ease 0.3s;
}
.page8-subtitle.show { opacity:1; transform:translateY(0); }

/* —— 故事段落 —— */
.story-container { max-width:900px; margin:0 auto; position:relative; }
.story-paragraph {
    font-size:1.8rem; line-height:1.6; color:#333;
    margin-bottom:120px; text-align:center;
    opacity:0; transform:translateY(50px);
    transition:all 1s ease; padding:0 20px; box-sizing:border-box;
}
.story-paragraph.show { opacity:1; transform:translateY(0); }
.highlight-quote { color:#d35400; font-weight:700; font-size:1.8rem; }

/* —— 图片卡片 —— */
.image-section {
    margin:150px 0; opacity:0; transform:scale(0.8) translateY(50px);
    transition:all 1.2s ease;
}
.image-section.show { opacity:1; transform:scale(1) translateY(0); }
.image-card { background:#fff; border-radius:25px; padding:40px;
    box-shadow:0 20px 60px rgba(0,0,0,0.1); position:relative;
    overflow:hidden; transition:all 0.3s ease;
}
.image-card:hover { transform:translateY(-10px); box-shadow:0 30px 80px rgba(0,0,0,0.15); }
.image-card::before { content:''; position:absolute; top:0; left:0; right:0; height:6px;
    background:linear-gradient(135deg,#f39c12,#e67e22);
}
.story-image { width:100%; max-width:600px; height:350px; object-fit:cover;
    border-radius:20px; margin:0 auto 30px; display:block;
    box-shadow:0 10px 30px rgba(0,0,0,0.1);
}
.image-title { font-size:2rem; font-weight:600; color:#2c3e50; text-align:center; margin-bottom:20px; }
.image-description { font-size:1.4rem; line-height:1.8; color:#555; text-align:center; margin-bottom:20px; }
.image-source { font-size:1rem; color:#888; text-align:center; font-style:italic; }
.price-highlight { color:#e74c3c; font-weight:700; background:linear-gradient(120deg,#fff5f5,#ffe0e0);
    padding:4px 8px; border-radius:6px; display:inline-block; margin:0 5px;
}

/* —— 词云图 —— */
.wordcloud-section { margin:150px 0; text-align:center; opacity:0; transform:translateY(50px);
    transition:all 1s ease;
}
.wordcloud-section.show { opacity:1; transform:translateY(0); }
.wordcloud-title { font-size:2.2rem; font-weight:600; color:#2c3e50; margin-bottom:30px; }
.wordcloud-image { max-width:100%; height:auto; border-radius:15px; box-shadow:0 15px 40px rgba(0,0,0,0.1); }

/* —— 过渡文本 —— */
.chart-transition { margin:150px 0 100px; text-align:center; opacity:0; transform:translateY(50px);
    transition:all 1s ease;
}
.chart-transition.show { opacity:1; transform:translateY(0); }
.transition-text { font-size:1.8rem; line-height:1.8; color:#555; background:#fff;
    padding:40px; border-radius:20px; box-shadow:0 10px 30px rgba(0,0,0,0.08);
}

/* —— ECharts 容器 —— */
/* —— 第八页舆情图表容器 —— */
.page8-chart {
    max-width: 1200px;
    margin: 0 auto;
    background: #fff;
    border-radius: 20px;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
    overflow: hidden;

    /* 初始隐藏 & 动画 */
    opacity: 0;
    transform: translateY(50px);
    transition: all 1s ease;

    /* —— 新增这一行 —— */
    min-height: 800px;    /* 保证容器足够高，缓解动画卡顿 */
}

.page8-chart.show {
    opacity: 1;
    transform: translateY(0);
}

/* —— ECharts 挂载点 —— */
#main {
    width: 100%;
    /* —— 改成百分比，让它撑满父容器 —— */
    height: 100%;
    /* —— 新增这一行 —— */
    min-height: 800px;    /* 和 .page8-chart 保持一致 */

    background: transparent;
}


/* —— 响应式 —— */
@media(max-width:768px){
  .page8-title{font-size:2.5rem;}
  .story-paragraph{font-size:1.5rem;margin-bottom:80px;}
  .highlight-quote{font-size:1.5rem;}
  .story-image{height:250px;}
  .image-card{padding:25px;}
}
@media(max-width:480px){
  .page-8{padding:40px 15px;}
  .story-paragraph{font-size:1.3rem;}
}
/* 整体卡片容器 */
.network-card {
  margin: 60px auto;
  max-width: 1200px;
  background: white;
  border-radius: 16px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.1);
  overflow: hidden;
  position: relative;
}

/* 卡片头部 */
.network-card .header {
  padding: 24px;
  text-align: center;
  position: relative;
}
.network-card .header h1 {
  font-size: 24px;
  color: #1f2937;
  margin-bottom: 8px;
}
.network-card .header .subtitle {
  font-size: 14px;
  color: #6b7280;
}

/* 布局切换按钮 */
.network-card .controls {
  position: absolute;
  top: 24px;
  right: 24px;
  display: flex;
  gap: 12px;
}
.net-btn {
  padding: 8px 20px;
  border-radius: 8px;
  border: none;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s ease;
  color: white;
}
.net-btn-primary { background: #f59e0b; }
.net-btn-secondary { background: #6366f1; }
.net-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

/* 可视化区域 */
#networkVisualization {
  position: relative;
  background: #fafafa;
  min-height: 800px;
}
#networkVisualization svg {
  width: 100%;
  height: 800px;
}

/* 图例 */
.network-card .legend {
  position: absolute;
  left: 24px;
  top: 24px;
  background: white;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}
.network-card .legend .legend-item {
  display: flex;
  align-items: center;
  margin-bottom: 10px;
  font-size: 14px;
}
.network-card .legend .legend-color {
  width: 20px;
  height: 20px;
  border-radius: 4px;
  margin-right: 8px;
}

/* 悬浮提示框 */
.network-tooltip {
  position: absolute;
  padding: 12px;
  background: rgba(0,0,0,0.85);
  color: white;
  border-radius: 8px;
  font-size: 14px;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.3s;
  z-index: 1000;
}

/* 网络节点和连线 */
.network-card .node {
  cursor: pointer;
}
.network-card .node circle {
  stroke: white;
  stroke-width: 2px;
  transition: all 0.3s ease;
}
.network-card .node text {
  font-size: 12px;
  text-anchor: middle;
  pointer-events: none;
  fill: #374151;
}
.network-card .link {
  fill: none;
  stroke-opacity: 0.4;
  stroke-linecap: round;
}

/* 高亮 & 弱化效果 */
.network-card .highlight {
  opacity: 1 !important;
}
.network-card .fade {
  opacity: 0.1 !important;
}


        /* 特殊动画效果 */
        @keyframes cardFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .poker-card:hover {
            animation: cardFloat 3s ease-in-out infinite;
        }

        /* 加载动画 */
        @keyframes shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }

        .poker-card.loading .card-front {
            background: linear-gradient(
                90deg,
                #f0f0f0 25%,
                #e0e0e0 50%,
                #f0f0f0 75%
            );
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        } 
    </style>
</head>
<body>
    <!-- 第一页：封面页 -->
    <div class="page-1" id="page1">
        <h1 class="title">医保谈判的七年：救命药真的便宜了吗？</h1>
        <h2 class="subtitle">患者呼声未止，还有哪些药品亟待纳入国谈药？</h2>
        <div class="scroll-hint">
            <div class="scroll-text">向下滚动开始探索</div>
            <div class="scroll-arrow">↓</div>
        </div>
    </div>

    <!-- 第二页：谈判现场语录 -->
    <div class="page-2" id="page2">
        <div class="quotes-container" id="quotesContainer">
            <!-- 语录会通过JavaScript动态添加 -->
        </div>
        <div class="scene-description" id="sceneDescription">
            <p class="scene-text">这是2024年国家医保药品目录谈判现场最"平常"</p>
            <p class="scene-text">却也最牵动人心的一幕。</p>
            <p class="scene-text">长桌两侧，</p>
            <p class="scene-text">一边是药企代表，</p>
            <p class="scene-text highlight">他们考虑的是研发投入、定价逻辑与市场博弈；</p>
            <p class="scene-text">另一边是国家医保谈判专家，</p>
            <p class="scene-text highlight">他们关注的，是无数普通患者是否能够按时、长期用上救命药。</p>
            <p class="scene-text">在这张谈判桌上，每一粒药的定价，都是多方利益的最佳平衡点</p>
            <p class="scene-text">——既要保证药企的创新回报，维系医药研发的可持续性；</p>
            <p class="scene-text">又要突破"天价药"的桎梏，让救命药真正惠及普通患者。</p>
            <p class="scene-text">一场谈判，</p>
            <p class="scene-text">改变的从不只是几个数字，</p>
            <p class="scene-text highlight">而是无数家庭的命运轨迹。</p>
        </div>
    </div>

    <section class="page-2-5" id="page2-5">
        <div class="transition-content">
          <h2 class="transition-title">这些经过多轮“灵魂砍价”后被纳入医保目录的药品</h2>
          <h2 class="final-text">有一个共同的名字——“国谈药”。</h2>
          <div class="medicine-box-container" id="medicineBoxContainer">
            <img src="国谈药.jpg"
                 alt="医保药盒"
                 class="medicine-box-img">
          </div>
        </div>
      </section>
      
    

    <!-- 第三页：国谈药定义 -->
    <div class="page-3" id="page3">
        <div class="definition-container">
            
            
            <div class="definition-card fade-in-element">
                <div class="definition-content">
                    <h3>国家医保谈判药品（简称"国谈药"）</h3>
                    <p>是指医保部门与药品生产企业通过价格谈判，确定支付标准后，纳入医保目录报销并处于协议期的药品。</p>
                    <p class="highlight-text">"国谈药"均为企业独家生产的药品，多数为创新药。</p>
                    <p>目前，<span class="highlight">现行"国谈药"涵盖肿瘤、罕见病、高血压、糖尿病用药等多个治疗领域</span>，如治疗肿瘤的注射用卡瑞利珠单抗、治疗罕见病的诺西那生钠注射液等。</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 第四页：逐个展示药品 -->
    <div class="page-4" id="page4">
        <h2 class="section-title fade-in-element">价格低、能报销，就是国谈药？</h2>
        
        <div class="sticky-container">
            <!-- 国谈药 -->
            <div class="drug-card" id="drug1">
                <div class="drug-avatar">
                    <img src="doc1.jpg" alt="国谈药医生">
                </div>
                <div class="drug-content">
                    <p>"我是<span class="highlight">国谈药</span>，由医保部门与我所在药企通过正式谈判后，才进入医保目录。</p>
                    <p>因为我<span class="highlight">通常是独家生产、价格昂贵的创新药</span>，所以需要谈清价格与协议期限。</p>
                    <p>只有谈成了，我才能在协议期内被纳入医保，并享受报销。"</p>
                </div>
            </div>

            <!-- 集采药 -->
            <div class="drug-card" id="drug2">
                <div class="drug-avatar">
                    <img src="doc2.jpg" alt="集采药医生">
                </div>
                <div class="drug-content">
                    <p>"我是<span class="highlight">集采药</span>，是由<span class="highlight">国家组织统一采购、集中中标</span>进来的药。</p>
                    <p>我不是独家药，而是<span class="highlight">可以替代、用量大、竞争多</span>的药品。</p>
                    <p>通过带量采购，我和一大批兄弟一起拼低价、拼产能，压下成本，也减轻了医院和患者的负担。"</p>
                </div>
            </div>

            <!-- 竞价药 -->
            <div class="drug-card" id="drug3">
                <div class="drug-avatar">
                    <img src="doc3.jpg" alt="竞价药医生">
                </div>
                <div class="drug-content">
                    <p>"我是<span class="highlight">竞价药</span>，也叫'竞价进入医保目录的药品'。</p>
                    <p>我的适用范围通常是<span class="highlight">非独家生产</span>的药品，通过医保部门组织的<span class="highlight">招标挂网</span>，由药企竞价决定谁能进医保。</p>
                    <p>我也要降价才能进目录，但不像国谈药那样逐个谈，而是<span class="highlight">靠市场竞争来定价。</span>"</p>
                </div>
            </div>
        </div>
    </div>
    
<!-- ================= 第五页 - 国家药品目录调整流程 ================= -->
<div class="page-5" id="page5">
    <!-- 引导文字，落点处换行 -->
    <h2 class="page5-title">一款药品需要经历怎样的流程，<br>才能真正“进医保”？</h2>
    <p class="intro-text white-text">
      无论是谈判、竞价，还是集中采购，药品最终的落点，<br>
      都是《国家基本医疗保险工伤保险和生育保险药品目录》
    </p>
    <p class="intro-text white-text">但进入目录，并非一蹴而就</p>
  
    <!-- 这里把那句话改成标题 -->
    
    <!-- 流程图容器 -->
    <div class="roadmap-container">
      <div class="header">
        <h1 class="main-title">国家药品目录调整流程</h1>
      </div>
  
      <div class="roadmap-path">
        <!-- SVG 路径（阴影 / 主线 / 高亮流向）-->
        <svg class="path-svg" viewBox="0 0 1200 400">
          <defs>
            <linearGradient id="pathGradient" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" style="stop-color:#667eea"/>
              <stop offset="20%" style="stop-color:#4A90E2"/>
              <stop offset="40%" style="stop-color:#67B7DC"/>
              <stop offset="60%" style="stop-color:#89CDF1"/>
              <stop offset="80%" style="stop-color:#67B7DC"/>
              <stop offset="100%" style="stop-color:#764ba2"/>
            </linearGradient>
            <linearGradient id="pathHighlight" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" style="stop-color:#ffffff; stop-opacity:0.9"/>
              <stop offset="50%" style="stop-color:#ffffff; stop-opacity:0.6"/>
              <stop offset="100%" style="stop-color:#ffffff; stop-opacity:0.9"/>
            </linearGradient>
          </defs>
          <path class="path-shadow"
                d="M 120 120 C 200 320, 280 350, 320 320 
                   C 360 290, 480 200, 560 160 
                   C 640 120, 720 250, 800 360 
                   C 880 470, 960 180, 1040 120"/>
          <path class="path-line"
                d="M 120 120 C 200 320, 280 350, 320 320 
                   C 360 290, 480 200, 560 160 
                   C 640 120, 720 250, 800 360 
                   C 880 470, 960 180, 1040 120"/>
          <path class="path-highlight"
                d="M 120 120 C 200 320, 280 350, 320 320 
                   C 360 290, 480 200, 560 160 
                   C 640 120, 720 250, 800 360 
                   C 880 470, 960 180, 1040 120"/>
        </svg>
  
        <!-- 五个流程节点，去掉 onclick，只保留 class -->
        <div class="step-node step-1">
          <div class="node-circle"><span class="node-number">01</span></div>
          <div class="step-label">准备阶段</div>
        </div>
        <div class="step-node step-2">
          <div class="node-circle"><span class="node-number">02</span></div>
          <div class="step-label">申报阶段</div>
        </div>
        <div class="step-node step-3">
          <div class="node-circle"><span class="node-number">03</span></div>
          <div class="step-label">专家评审</div>
        </div>
        <div class="step-node step-4">
          <div class="node-circle"><span class="node-number">04</span></div>
          <div class="step-label">谈判/竞价</div>
        </div>
        <div class="step-node step-5">
          <div class="node-circle"><span class="node-number">05</span></div>
          <div class="step-label">公布结果</div>
        </div>
        <div class="click-tip">点击查看具体流程</div>
      </div>
  
      <!-- 详情面板 -->
      <div id="details-panel" class="details-panel">
        <div id="details-content"></div>
      </div>
    </div>
  </div>
  <!-- ================= 第六页：文字引入 + 交互式图表 + 统计数据 ================= -->
<!-- ================= 第六页：数字轨迹 ================= -->
<div class="page-6" id="page6">
    <!-- 上半段文字（保持原来的 .text-section 宽度） -->
    <div class="text-section">
      <h2 class="page6-text">从十几种到百余种：医保谈判走过的七年</h2>
      <p class="page6-text">自<span class="highlight-number">2018</span>年起，</p>
      <p class="page6-text">国家医保谈判进入常态化运行，</p>
      <p class="page6-text">也在一年又一年的数字里，留下了清晰的变化轨迹。</p>
      <p class="page6-text">这七年里，</p>
      <p class="page6-text">共有<span class="highlight-number">754</span>种药品参与谈判，</p>
      <p class="page6-text">其中<span class="highlight-number">658</span>种成功进入医保目录。</p>
      <p class="page6-text">从最初的十几种，</p>
      <p class="page6-text">到近年每年稳定在<span class="highlight-number">120</span>种左右，</p>
      <p class="page6-text">谈判的覆盖面不断扩大。</p>
      <p class="page6-text">而比数量更让人惊喜的，</p>
      <p class="page6-text">是价格的变化。</p>
      <p class="page6-text">七年来，</p>
      <p class="page6-text">新增药品的平均降价幅度始终保持在<span class="highlight-number">50%</span>以上，</p>
      <p class="page6-text">个别药品甚至降幅超过<span class="highlight-number">90%</span>。</p>
    </div>
  
    <!-- —— 全宽容器：图表 + 统计面板 —— -->
    <div class="full-width-block">
      <div class="chart-container" style="width:100%; max-width:1200px; height:700px; margin:0 auto 40px;">
        <div id="chart" style="width:100%; height:100%;"></div>
      </div>
  
      <div class="stats-panel" style="max-width:1200px; margin:0 auto 60px;">
        <div class="stats-grid" style="display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:20px;">
          <div class="stat-item">
            <div class="stat-number">754</div>
            <div class="stat-label">总谈判品种数量</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">658</div>
            <div class="stat-label">总成功数量</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">87%</div>
            <div class="stat-label">平均成功率</div>
          </div>
          <div class="stat-item">
            <div class="stat-number">60%</div>
            <div class="stat-label">平均降价幅度</div>
          </div>
        </div>
      </div>
    </div>
  
    <!-- 下半段文字（继续使用 .text-section） -->
    <div class="text-section">
      <p class="page6-text">这一连串数字背后，</p>
      <p class="page6-text">不只是一次次"灵魂砍价"，</p>
      <p class="page6-text">更是把无数患者从高价药前"望而却步"的门槛，</p>
      <p class="page6-text">重新拉回了可承受的起点。</p>
      <p class="page6-text">它不只是调控，更是现实的托底。</p>
      <p class="page6-text">在每一次定价锤定之后，</p>
      <p class="page6-text">都可能藏着一个家庭松了一口气的声音。</p>
    </div>
  </div>
  
  
  <!-- ================= 第七页：从高价救命药到普适性药物 ================= -->
<div class="page-7" id="page7">
    <!-- 标题和导语部分 -->
    <div class="page7-header">
        <h2 class="page7-title fade-in-element">从高价救命药到普适性药物，每一类人群都在被看到</h2>
        <div class="page7-intro fade-in-element">
            <p>七年来，那些曾经"遥不可及"的高价靶向药、罕见病药，渐渐被纳入；</p>
            <p>而那些关乎数亿人日常健康的慢性病药、儿童用药，也没有被遗漏。</p>
        </div>
    </div>

    <!-- 扑克牌展示区域 -->
    <div class="poker-cards-container fade-in-element">
        <div class="poker-card" data-category="cancer">
            <div class="card-inner">
                <div class="card-front">
                    <div class="card-icon">
                        <svg viewBox="0 0 100 100">
                            <!-- 癌症治疗图标 -->
                            <circle cx="50" cy="50" r="45" fill="#ed5f5f" opacity="0.2"/>
                            <path d="M50 20 L65 40 L60 50 L50 45 L40 50 L35 40 Z" fill="#ed5f5f"/>
                            <circle cx="50" cy="50" r="15" fill="#ed5f5f"/>
                        </svg>
                    </div>
                    <h3 class="card-title">癌症治疗药物</h3>
                    <div class="card-number">150</div>
                    <p class="card-desc">累计纳入品种</p>
                </div>
                <div class="card-back">
                    <h4>保障重点</h4>
                    <p>靶向药、免疫治疗药物</p>
                    <p>每年稳定新增约20种</p>
                    <p>让"救命药"不再遥不可及</p>
                </div>
            </div>
        </div>

        <div class="poker-card" data-category="chronic">
            <div class="card-inner">
                <div class="card-front">
                    <div class="card-icon">
                        <svg viewBox="0 0 100 100">
                            <!-- 慢性病图标 -->
                            <rect x="25" y="35" width="50" height="30" rx="15" fill="#ffa74f" opacity="0.3"/>
                            <path d="M30 50 Q50 30, 70 50 T90 50" fill="none" stroke="#ffa74f" stroke-width="3"/>
                            <circle cx="50" cy="50" r="5" fill="#ffa74f"/>
                        </svg>
                    </div>
                    <h3 class="card-title">慢性病管理药物</h3>
                    <div class="card-number">211</div>
                    <p class="card-desc">累计纳入品种</p>
                </div>
                <div class="card-back">
                    <h4>覆盖病种</h4>
                    <p>高血压、糖尿病、心脑血管</p>
                    <p>2020-2022年高速增长</p>
                    <p>减轻亿万患者用药负担</p>
                </div>
            </div>
        </div>

        <div class="poker-card" data-category="rare">
            <div class="card-inner">
                <div class="card-front">
                    <div class="card-icon">
                        <svg viewBox="0 0 100 100">
                            <!-- 罕见病图标 -->
                            <polygon points="50,20 60,40 80,40 65,55 75,75 50,60 25,75 35,55 20,40 40,40" fill="#53a8e1" opacity="0.3"/>
                            <circle cx="50" cy="50" r="8" fill="#53a8e1"/>
                        </svg>
                    </div>
                    <h3 class="card-title">罕见病药物</h3>
                    <div class="card-number">65</div>
                    <p class="card-desc">累计纳入品种</p>
                </div>
                <div class="card-back">
                    <h4>里程碑意义</h4>
                    <p>2019年起稳步拓展</p>
                    <p>覆盖多类稀有病种</p>
                    <p>为小众群体撑起保护伞</p>
                </div>
            </div>
        </div>

        <div class="poker-card" data-category="other">
            <div class="card-inner">
                <div class="card-front">
                    <div class="card-icon">
                        <svg viewBox="0 0 100 100">
                            <!-- 其他药物图标 -->
                            <rect x="35" y="25" width="30" height="50" rx="5" fill="#9a72c7" opacity="0.3"/>
                            <circle cx="50" cy="40" r="10" fill="#9a72c7"/>
                            <path d="M40 55 L60 55" stroke="#9a72c7" stroke-width="3"/>
                        </svg>
                    </div>
                    <h3 class="card-title">其他类别药物</h3>
                    <div class="card-number">232</div>
                    <p class="card-desc">累计纳入品种</p>
                </div>
                <div class="card-back">
                    <h4>多元保障</h4>
                    <p>儿童用药、精神类用药</p>
                    <p>感染性疾病用药等</p>
                    <p>满足不同人群特殊需求</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 统计数据详细说明 -->
    <div class="statistics-section fade-in-element">
        <div class="stat-paragraph" data-category="cancer">
            <div class="stat-icon">📊</div>
            <p>统计数据显示，2018年至2024年间，<span class="highlight-stat">肿瘤治疗相关药物累计有150种纳入医保</span>，基本保持每年约20种的稳定新增，凸显国家对重大疾病药物可及性和可负担性保障的长期承诺。</p>
        </div>

        <div class="stat-paragraph" data-category="chronic">
            <div class="stat-icon">📈</div>
            <p>慢性病用药方面，呈现出显著上升趋势，特别是在2020至2022年间连续三年处于高位，<span class="highlight-stat">累计共有211种相关药品进入医保目录</span>，显示出政策对高血压、糖尿病等常见慢性病患者用药负担问题的积极回应。</p>
        </div>

        <div class="stat-paragraph" data-category="rare">
            <div class="stat-icon">🌟</div>
            <p>自2019年起，罕见病药物保障范围稳步拓展，<span class="highlight-stat">至2024年已累计纳入65种</span>，初步建立起覆盖多类稀有病种的基础医保支持框架。</p>
        </div>

        <div class="stat-paragraph" data-category="other">
            <div class="stat-icon">🏥</div>
            <p>此外，儿童用药、感染性疾病用药、精神类用药等其他类别药品则呈现波动式增长，<span class="highlight-stat">总量已达232种</span>，体现出医保目录结构在多元人群用药需求之间的平衡与适应。</p>
        </div>
    </div>

    <!-- 气泡图容器 -->
    <div class="bubble-chart-container fade-in-element">
        <h3 class="chart-title">2017-2024年各类药物纳入数量分布</h3>
        <div id="bubbleChart" style="width: 100%; height: 500px;"></div>
    </div>

    
</div>

<!-- 第八页：舆情动态分析 -->
<!-- 第八页：舆情动态分析 -->
<div class="page-8" id="page8">
    <h2 class="page8-title" data-scroll="title">舆情温度计：医保谈判背后的情感图谱</h2>
    <p  class="page8-subtitle" data-scroll="subtitle">让"罕见"被看见，让爱不罕见！</p>
  
    <div class="story-container">
      <div class="story-paragraph" data-scroll="story1">
        钱冰桥的货车后座总铺着软垫，6岁的儿子趴在上面，看窗外车流掠过。
      </div>
      <div class="story-paragraph" data-scroll="story2">
        孩子腰椎侧弯如弓，肌肉无力到无法坐直——2017年确诊SMA那天起，"无药可医"四个字像车辙印，碾在这个父亲的日子里。
      </div>
      <div class="story-paragraph" data-scroll="story3">
        2019年，特效药"诺西那生钠"获批的消息曾让病友群刷屏，但70万元一针的高昂标价让"有药可医"变得不真切。
      </div>
      <div class="story-paragraph" data-scroll="story4">
        按推荐疗程，6针、终身维持——费用足够在老家盖几栋楼。
      </div>
  
      <div class="image-section" data-scroll="image1">
        <div class="image-card">
          <img src="诺西那生钠.jpg" alt="诺西那生钠注射液" class="story-image">
          <h3 class="image-title">这就是那支改变命运的药</h3>
          <p class="image-description">
            诺西那生钠注射液，治疗SMA（脊髓性肌萎缩症）的特效药。<br>
            从<span class="price-highlight">70万元一针</span>到最终的<span class="price-highlight">3.3万元</span>，
            每一分钱的降价都承载着无数家庭的希望。
          </p>
          <p class="image-source">图片来源：视觉中国</p>
        </div>
      </div>
  
      <div class="story-paragraph" data-scroll="story5">
        <span class="highlight-quote">"就像看着救命绳在眼前，却够不着。"</span>
      </div>
  
      <div class="story-paragraph" data-scroll="story6">
        转折点出现在2021年11月的医保谈判间。福建医保局张劲妮握着话筒，对药企代表重复："每一个小群体都不应该被放弃。"
      </div>
  
      <div class="image-section" data-scroll="image2">
        <div class="image-card">
          <img src="谈判现场.jpg" alt="医保谈判现场" class="story-image">
          <h3 class="image-title">决定命运的关键时刻</h3>
          <p class="image-description">
            2021年医保谈判现场，每一次报价的背后都是生命的重量。<br>
            在这个会议室里，决策者们用责任和坚持为患者争取希望。
          </p>
          <p class="image-source">图片来源：CCTV1新闻</p>
        </div>
      </div>
  
      <div class="story-paragraph" data-scroll="story7">
        当企业报价从5.368万一路降到3.402万，她依然摇头："我们的底价空间是0。"最终，3.3万的数字落下时，不少人红了眼眶。
      </div>
  
      <div class="story-paragraph" data-scroll="story8">
        2022年1月1日，诺西那生钠正式纳入医保，同日，全国已有11省市近20名患者完成注射。
      </div>
  
      <div class="story-paragraph" data-scroll="story9">
        <span class="highlight-quote">"现在一切的辛酸值了。"</span>
      </div>
  
      <div class="wordcloud-section" data-scroll="wordcloud">
        <h3 class="wordcloud-title">网络声音：医保谈判的民意温度</h3>
        <img src="词云图.jpg" alt="舆情词云分析图" class="wordcloud-image">
      </div>
  
      <div class="chart-transition" data-scroll="transition">
        <div class="transition-text">
            本词云图以“医保谈判 罕见病”为关键词，采集相关微博下的评论内容（共计约1600条）生成，直观反映了公众在该议题中的关注焦点与情感倾向。从词频分布来看，“关注”“支持”“让利患者”“药价透明”“人民健康”“惠及百姓”等关键词高频出现，表明网民普遍聚焦于罕见病药品在医保谈判中的药品降价、患者减负与用药保障等方面的实际成效。
            <br><br>
            “社会共赢”“减负”“生命至上”“携手”等词语的出现，也体现出公众对制度公平性、医保覆盖广度以及公共利益实现的高度关注。
        </div>
      </div>
    </div>
  
    <div class="page8-chart" data-scroll="chart">
      <div id="main"></div>
    </div>
    <div class="network-card container">
        <div class="header">
          <h1>医保谈判关键词关系网络</h1>
          <p class="subtitle">圆形布局 ▪ 基于频次和相关性</p>
          <div class="controls">
            <button class="btn btn-primary" onclick="changeNetworkLayout('circular')">圆形布局</button>
            <button class="btn btn-secondary" onclick="changeNetworkLayout('force')">力导向布局</button>
            <button class="btn btn-tertiary" onclick="changeNetworkLayout('radial')">切换标签</button>
            <button class="btn btn-quaternary" onclick="resetView()">重置视图</button>
          </div>
        </div>
      
        <div id="networkVisualization">
          <div class="legend">
            <div class="legend-item">
              <div class="legend-color" style="background: #3b82f6;"></div>
              <span>政策核心</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background: #f59e0b;"></div>
              <span>药品医疗</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background: #10b981;"></div>
              <span>经济价格</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background: #ec4899;"></div>
              <span>患者群体</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background: #8b5cf6;"></div>
              <span>医药企业</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background: #f97316;"></div>
              <span>医疗机构</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background: #06b6d4;"></div>
              <span>正面情绪</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background: #ef4444;"></div>
              <span>负面情绪</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background: #6b7280;"></div>
              <span>中性分析</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background: #84cc16;"></div>
              <span>地区相关</span>
            </div>
          </div>
        </div>
      
        <div class="network-tooltip tooltip"></div>
        <div class="tooltip"></div>
      </div>
  <!-- 一定要在这里确保已经引入 ECharts -->

  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
  
  
  
    <script>
        // ================= 第2.5页独立JavaScript代码 =================
(function() {
    'use strict';
    
    console.log('第2.5页JavaScript开始加载');
    
    // 等待DOM加载完成
    function initPage25() {
        const medicineBox = document.getElementById('medicineBoxContainer');
        
        if (!medicineBox) {
            console.log('未找到药盒容器，延迟重试');
            setTimeout(initPage25, 500);
            return;
        }
        
        console.log('找到药盒容器，开始初始化');
        
        // 创建额外的粒子元素
        function createParticle() {
            const particle = document.createElement('div');
            particle.className = 'extra-particle';
            
            // 随机位置
            const randomX = Math.random() * 20 + 40; // 20%-80%
            const randomY = Math.random() * 40 + 30; // 30%-70%
            
            particle.style.cssText = `
                position: absolute;
                width: 12px;
                height: 12px;
                background: #f39c12;
                border-radius: 50%;
                top: ${randomY}%;
                left: ${randomX}%;
                opacity: 0;
                pointer-events: none;
                z-index: 1;
                animation: extraParticle ${2 + Math.random() * 2}s ease-out ${Math.random() * 2}s infinite;
            `;
            
            return particle;
        }
        
        // 延迟添加粒子（等药盒出现后）
        setTimeout(() => {
            if (medicineBox) {
                console.log('开始添加粒子效果');
                // 创建4-6个额外粒子
                const particleCount = 6 + Math.floor(Math.random() * 3);
                for (let i = 0; i < particleCount; i++) {
                    const particle = createParticle();
                    medicineBox.appendChild(particle);
                }
                console.log(`已添加 ${particleCount} 个粒子`);
            }
        }, 2500); // 等待药盒动画完成
        
        // 添加关键词交互效果
        setTimeout(() => {
            const keyword = document.querySelector('.keyword');
            if (keyword && !keyword.classList.contains('enhanced')) {
                keyword.classList.add('enhanced');
                console.log('添加关键词交互效果');
                
                // 鼠标悬停效果
                keyword.addEventListener('mouseenter', function() {
                    this.style.filter = 'drop-shadow(0 0 25px rgba(243, 156, 18, 0.8))';
                    this.style.transform = 'scale(1.05)';
                    this.style.transition = 'all 0.3s ease';
                });
                
                keyword.addEventListener('mouseleave', function() {
                    this.style.filter = 'drop-shadow(0 0 10px rgba(243, 156, 18, 0.3))';
                    this.style.transform = 'scale(1)';
                });
                
                // 点击效果
                keyword.addEventListener('click', function() {
                    this.style.animation = 'textGlow 1s ease-out';
                    setTimeout(() => {
                        this.style.animation = '';
                    }, 1000);
                });
            }
        }, 3000);
    }
    
    // 监听滚动，确保动画在合适时机触发
    function checkPage25InView() {
        const page25 = document.getElementById('page2-5');
        if (!page25) return false;
        
        const rect = page25.getBoundingClientRect();
        const windowHeight = window.innerHeight;
        
        // 当第2.5页进入视野时返回true
        return rect.top < windowHeight * 0.8 && rect.bottom > windowHeight * 0.2;
    }
    
    let page25Initialized = false;
    
    function handleScroll() {
        if (!page25Initialized && checkPage25InView()) {
            console.log('第2.5页进入视野，开始初始化');
            page25Initialized = true;
            initPage25();
        }
    }
    
    // 如果页面已经加载完成
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM加载完成，初始化第2.5页');
            setTimeout(initPage25, 100);
            
            // 添加滚动监听
            window.addEventListener('scroll', handleScroll);
            
            // 立即检查一次
            setTimeout(handleScroll, 500);
        });
    } else {
        // DOM已经加载完成
        console.log('DOM已加载，直接初始化第2.5页');
        setTimeout(initPage25, 100);
        
        // 添加滚动监听
        window.addEventListener('scroll', handleScroll);
        
        // 立即检查一次
        setTimeout(handleScroll, 500);
    }
    
    // 调试函数
    window.debugPage25 = function() {
        console.log('=== 第2.5页调试信息 ===');
        console.log('- 药盒容器:', document.getElementById('medicineBoxContainer'));
        console.log('- 粒子数量:', document.querySelectorAll('.extra-particle').length);
        console.log('- 关键词元素:', document.querySelector('.keyword'));
        console.log('- 页面初始化状态:', page25Initialized);
        console.log('- 当前是否在视野内:', checkPage25InView());
    };
    
})();
        // 第五页流程图函数 - 放在全局作用域最前面
        const stageDetails = {
            1: {
                title: "准备阶段",
                time: "5月-6月",
                items: [
                    {
                        title: "制定工作方案",
                        description: "确定年度医保目录调整的总体方案和具体实施计划"
                    },
                    {
                        title: "完善谈判规则",
                        description: "制定和完善药品续订、新增等各类谈判规则"
                    },
                    {
                        title: "优化信息系统",
                        description: "升级完善申报和评审相关的信息化系统"
                    }
                ]
            },
            2: {
                title: "申报阶段",
                time: "7月-8月",
                items: [
                    {
                        title: "企业提交材料",
                        description: "医药企业按要求提交药品申报相关材料"
                    },
                    {
                        title: "形式审查",
                        description: "对企业提交的申报材料进行形式审查"
                    },
                    {
                        title: "公示复核",
                        description: "公示审查结果，进行复核，并将结果反馈给企业"
                    }
                ]
            },
            3: {
                title: "专家评审",
                time: "8月-9月",
                items: [
                    {
                        title: "组织联合评审",
                        description: "组织医学、药学、经济学等领域专家开展联合评审"
                    },
                    {
                        title: "系统化评估",
                        description: "对药品的安全性、有效性、经济性进行综合评估"
                    },
                    {
                        title: "反馈评审结果",
                        description: "通过申报系统向企业反馈专家评审结果"
                    }
                ]
            },
            4: {
                title: "谈判/竞价",
                time: "9月-10月",
                items: [
                    {
                        title: "提交谈判材料",
                        description: "组织企业提交谈判或竞价相关材料"
                    },
                    {
                        title: "支付标准测算",
                        description: "开展支付标准测算评估，确定合理价格区间"
                    },
                    {
                        title: "现场谈判",
                        description: "开展现场谈判或竞价，协商确定最终价格"
                    },
                    {
                        title: "签署协议",
                        description: "组织通过谈判的企业签署相关协议"
                    }
                ]
            },
            5: {
                title: "公布结果",
                time: "11月",
                items: [
                    {
                        title: "印发调整文件",
                        description: "正式印发关于医保目录调整的相关文件"
                    },
                    {
                        title: "公布调整结果",
                        description: "向社会公布药品目录调整的具体结果"
                    },
                    {
                        title: "发布新版目录",
                        description: "发布新版国家基本医疗保险药品目录"
                    }
                ]
            }
        };
        
        // 显示详细信息的主要函数 - 全局函数
        function showDetails(stageNumber) {
            console.log('点击了按钮:', stageNumber); // 调试用
            
            const panel = document.getElementById('details-panel');
            const content = document.getElementById('details-content');
            const stage = stageDetails[stageNumber];

            if (!panel || !content) {
                console.error('找不到面板元素');
                return;
            }

            // 如果点击的是当前显示的阶段，则关闭面板
            if (panel.classList.contains('active') && panel.dataset.currentStage == stageNumber) {
                panel.classList.remove('active');
                // 重置所有节点样式
                document.querySelectorAll('.step-node').forEach(node => {
                    node.style.transform = '';
                    node.style.zIndex = '';
                });
                return;
            }

            // 生成详细内容HTML
            let itemsHtml = '';
            stage.items.forEach(item => {
                itemsHtml += `
                    <div class="detail-item">
                        <h4>${item.title}</h4>
                        <p>${item.description}</p>
                    </div>
                `;
            });

            // 设置面板内容
            content.innerHTML = `
                <div class="details-title">
                    ${stage.title}
                    <div class="details-time">${stage.time}</div>
                </div>
                <div class="details-content">
                    ${itemsHtml}
                </div>
            `;

            // 显示面板
            panel.classList.add('active');
            panel.dataset.currentStage = stageNumber;

            // 高亮当前选中的节点
            document.querySelectorAll('.step-node').forEach(node => {
                node.style.transform = '';
                node.style.zIndex = '';
            });
            
            const currentNode = document.querySelector(`.step-${stageNumber}`);
            if (currentNode) {
                currentNode.style.transform = 'scale(1.15)';
                currentNode.style.zIndex = '10';
            }
        }
        // 在 DOMContentLoaded 里或合适的位置添加
        

        // 谈判语录数据
        const quotes = [
            '"3块钱一片，一天两片就是6块钱。患者需要长期服药，是持续的，这笔账必须算清楚。"',
            '"2块4毛3，能看出你们的诚意。"',
            '"我们专家组也回个价，2块1毛1。"'
        ];

        let quoteIndex = 0;
        let sceneTextIndex = 0;
        // 创建语录气泡
        function createQuoteBubble(quote, delay = 0) {
            setTimeout(() => {
                const container = document.getElementById('quotesContainer');
                const bubble = document.createElement('div');
                bubble.className = 'quote-bubble price';
                bubble.textContent = quote;
                
                container.appendChild(bubble);
                
                // 显示动画
                setTimeout(() => {
                    bubble.classList.add('show');
                }, 100);
                
            }, delay);
        }

        // 显示场景描述文字
        function showSceneText() {
            const sceneTexts = document.querySelectorAll('.scene-text');
            sceneTexts.forEach((text, index) => {
                setTimeout(() => {
                    text.classList.add('show');
                }, index * 300);
            });
        }

        // 滚动到第五页时的触发效果
        function triggerPage5Effects() {
            const page5 = document.getElementById('page5');
            if (page5) {
                console.log('第五页已进入视野');
                
                // 重新触发路径绘制动画
                const pathLine = page5.querySelector('.path-line');
                if (pathLine) {
                    pathLine.style.animation = 'none';
                    setTimeout(() => {
                        pathLine.style.animation = 'drawPath 4s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards';
                    }, 100);
                }
            }
        }
        let page6TextIndex = 0;

// 显示第六页文字的函数
        function showPage6Text() {
            const page6Texts = document.querySelectorAll('.page6-text');
            page6Texts.forEach((text, index) => {
                setTimeout(() => {
                    text.classList.add('show');
                }, index * 200); // 每个文字间隔200ms显示
            });
}

        // 滚动监听
        window.addEventListener('scroll', function() {
            const page1 = document.getElementById('page1');
            const page2 = document.getElementById('page2');
            const page3 = document.getElementById('page3');
            const page4 = document.getElementById('page4');
            const page5 = document.getElementById('page5');
            const scrollTop = window.pageYOffset;
            const windowHeight = window.innerHeight;
            
            // 第一页抽屉效果
            const drawerTrigger = windowHeight * 0.2;
            const drawerComplete = windowHeight * 0.8;
            
            if (scrollTop <= drawerTrigger) {
                page1.style.display = 'flex';
                page1.style.transform = 'translateY(0)';
                page1.style.opacity = '1';
            } else if (scrollTop >= drawerComplete) {
                page1.style.display = 'none';
            } else {
                page1.style.display = 'flex';
                const progress = (scrollTop - drawerTrigger) / (drawerComplete - drawerTrigger);
                const translateY = -100 * progress;
                page1.style.transform = `translateY(${translateY}%)`;
                page1.style.opacity = Math.max(0, 1 - progress * 1.5);
            }
            
            // 第二页语录显示
            if (page2) {
                const page2Top = page2.offsetTop - windowHeight;
                const page2Bottom = page2.offsetTop + page2.offsetHeight;
                
                if (scrollTop > page2Top && scrollTop < page2Bottom) {
                    const scrollProgress = (scrollTop - page2Top) / page2.offsetHeight;
                    
                    // 依次显示语录，间隔更大避免重叠
                    if (scrollProgress > 0.15 && quoteIndex === 0) {
                        createQuoteBubble(quotes[0], 0);
                        quoteIndex = 1;
                    }
                    if (scrollProgress > 0.25 && quoteIndex === 1) {
                        createQuoteBubble(quotes[1], 500);
                        quoteIndex = 2;
                    }
                    if (scrollProgress > 0.35 && quoteIndex === 2) {
                        createQuoteBubble(quotes[2], 1000);
                        quoteIndex = 3;
                    }
                    
                    // 显示场景描述
                    if (scrollProgress > 0.55 && sceneTextIndex === 0) {
                        showSceneText();
                        sceneTextIndex = 1;
                    }
                }
            }
            
            // 第三页内容淡入
            if (page3) {
                const page3Top = page3.offsetTop;
                const page3Elements = page3.querySelectorAll('.fade-in-element');
                
                if (scrollTop > page3Top - windowHeight * 0.8) {
                    page3Elements.forEach((element, index) => {
                        setTimeout(() => {
                            element.classList.add('show');
                        }, index * 300);
                    });
                }
            }

            // 第四页逐个展示药品效果
            if (page4) {
                const page4Top = page4.offsetTop;
                const page4Height = page4.offsetHeight;
                const titleElement = page4.querySelector('.section-title');
                
                if (scrollTop > page4Top - windowHeight && scrollTop < page4Top + page4Height - windowHeight) {
                    const relativeScroll = scrollTop - page4Top + windowHeight;
                    const progress = Math.min(relativeScroll / page4Height, 1);
                    
                    // 显示标题
                    if (progress > 0.05) {
                        titleElement.classList.add('show');
                    }
                    
                    // 控制三个药品卡片的显示
                    const drug1 = document.getElementById('drug1');
                    const drug2 = document.getElementById('drug2');
                    const drug3 = document.getElementById('drug3');
                    
                    if (drug1 && drug2 && drug3) {
                        // 重置所有状态
                        [drug1, drug2, drug3].forEach(drug => {
                            drug.classList.remove('active', 'exit-up');
                        });
                        
                        // 第一个药品 (10%-40%)
                        if (progress >= 0.1 && progress < 0.4) {
                            drug1.classList.add('active');
                        }
                        // 第二个药品 (40%-70%)
                        else if (progress >= 0.4 && progress < 0.7) {
                            drug2.classList.add('active');
                        }
                        // 第三个药品 (70%-95%)
                        else if (progress >= 0.7 && progress < 0.95) {
                            drug3.classList.add('active');
                        }
                    }
                } else {
                    // 重置状态
                    const titleElement = page4.querySelector('.section-title');
                    if (titleElement) titleElement.classList.remove('show');
                    
                    const drug1 = document.getElementById('drug1');
                    const drug2 = document.getElementById('drug2');
                    const drug3 = document.getElementById('drug3');
                    if (drug1 && drug2 && drug3) {
                        [drug1, drug2, drug3].forEach(drug => {
                            drug.classList.remove('active', 'exit-up');
                        });
                    }
                }
            }

            // 第五页效果
            // 第五页效果
            if (page5) {
                const page5Top = page5.offsetTop;
                if (scrollTop > page5Top - windowHeight * 0.8) {
                    triggerPage5Effects();
                }
            }

            // 第六页文字动画
            const page6 = document.getElementById('page6');
            if (page6) {
                const page6Top = page6.offsetTop;
                const page6Height = page6.offsetHeight;
                
                if (scrollTop > page6Top - windowHeight * 0.8 && scrollTop < page6Top + page6Height) {
                    const relativeScroll = scrollTop - page6Top + windowHeight * 0.8;
                    const progress = Math.min(relativeScroll / (page6Height * 0.6), 1);
                    
                    // 触发文字动画（只执行一次）
                    if (progress > 0.1 && page6TextIndex === 0) {
                        showPage6Text();
                        page6TextIndex = 1;
                    }
                }
            }
        });
        
        // 页面加载完成后的初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('页面已加载，初始化流程图');
            
            // 平滑滚动
            const scrollHint = document.querySelector('.scroll-hint');
            if (scrollHint) {
                scrollHint.addEventListener('click', function() {
                    const page2 = document.getElementById('page2');
                    if (page2) {
                        page2.scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                });
            }

            // 确保所有节点都有点击事件
            document.querySelectorAll('.step-node').forEach((node, index) => {
                node.addEventListener('click', function() {
                    const stageNumber = index + 1;
                    showDetails(stageNumber);
                });
            });
        });

        // 键盘导航支持
        document.addEventListener('keydown', function(e) {
            if (e.key >= '1' && e.key <= '5') {
                const stageNumber = parseInt(e.key);
                showDetails(stageNumber);
                e.preventDefault();
            }
            
            // ESC键关闭面板
            if (e.key === 'Escape') {
                const panel = document.getElementById('details-panel');
                if (panel && panel.classList.contains('active')) {
                    panel.classList.remove('active');
                    document.querySelectorAll('.step-node').forEach(node => {
                        node.style.transform = '';
                        node.style.zIndex = '';
                    });
                }
            }
        });

        // 移动端触摸优化
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.step-node').forEach(node => {
                // 触摸开始
                node.addEventListener('touchstart', function(e) {
                    this.style.transform = 'scale(1.05)';
                    e.preventDefault();
                });
                
                // 触摸结束
                node.addEventListener('touchend', function(e) {
                    setTimeout(() => {
                        if (!this.style.zIndex || this.style.zIndex !== '10') {
                            this.style.transform = '';
                        }
                    }, 200);
                    e.preventDefault();
                });
                
                // 触摸取消
                node.addEventListener('touchcancel', function() {
                    setTimeout(() => {
                        if (!this.style.zIndex || this.style.zIndex !== '10') {
                            this.style.transform = '';
                        }
                    }, 200);
                });
            });
        });

        // 点击面板外部关闭面板
        document.addEventListener('click', function(e) {
            const panel = document.getElementById('details-panel');
            const roadmapContainer = document.querySelector('.page-5 .roadmap-container');
            
            if (panel && panel.classList.contains('active') && roadmapContainer) {
                if (!roadmapContainer.contains(e.target)) {
                    panel.classList.remove('active');
                    document.querySelectorAll('.step-node').forEach(node => {
                        node.style.transform = '';
                        node.style.zIndex = '';
                    });
                }
            }
        });

        // 调试函数
        function debugPage5() {
            console.log('第五页调试信息：');
            console.log('- stageDetails:', stageDetails);
            console.log('- details-panel元素:', document.getElementById('details-panel'));
            console.log('- step-node元素数量:', document.querySelectorAll('.step-node').length);
            
            setTimeout(() => {
                showDetails(1);
            }, 1000);
        }
    </script>

     <!-- 第六页渲染与滚动触发脚本 -->
     <script>
       // 1. 把图表初始化逻辑封装成一个函数
       function renderChart() {
         const medicalData = {
           years: ['2018','2019','2020','2021','2022','2023','2024'],
           negotiation: [18,150,162,117,147,143,117],
           success:     [17, 97,119, 94,121,121, 89],
           reduction:   [57, 61, 51, 62, 60, 62, 63]
         };
         const successRate = medicalData.years.map((_, i) =>
           Math.round(medicalData.success[i] / medicalData.negotiation[i] * 100)
         );
   
         const chart = echarts.init(document.getElementById('chart'));
         const option = {
           title: {
             text: '2018–2024年医保谈判数据图',
             left: 'center',
             textStyle: { fontSize: 20, fontWeight: 600 },
             subtextStyle: { fontSize: 14, color: '#666' }
           },
           color: ['#afd3e7','#fca3a3','#fdcd8c','#d0bbdb'],
           tooltip: { trigger: 'axis', axisPointer: { type: 'shadow' } },
           legend: { data: ['谈判数','成功数','成功率','降价幅度'], top: '10%' },
           grid: { left: '8%', right: '8%', bottom: '15%', containLabel: true },
           xAxis: [{ type: 'category', data: medicalData.years, axisLine: { lineStyle: { color: '#ccc' } }, axisLabel: { fontSize: 12 } }],
           yAxis: [
             { type: 'value', name: '数量', axisLine: { lineStyle: { color: '#afd3e7' } }, axisLabel: { formatter: '{value}', fontSize: 12 } },
             { type: 'value', name: '百分比(%)', position: 'right', axisLine: { lineStyle: { color: '#fdcd8c' } }, axisLabel: { formatter: '{value}%', fontSize: 12 } }
           ],
           series: [
             {
               name: '谈判数',
               type: 'bar',
               data: medicalData.negotiation,
               itemStyle: { borderRadius: [4,4,0,0] },
               animationDuration: 2000,
               animationEasing: 'cubicOut'
             },
             {
               name: '成功数',
               type: 'bar',
               data: medicalData.success,
               itemStyle: { borderRadius: [4,4,0,0] },
               animationDuration: 2000,
               animationEasing: 'cubicOut'
             },
             {
               name: '成功率',
               type: 'line',
               yAxisIndex: 1,
               data: successRate,
               smooth: true,
               connectNulls: true,
               lineStyle: { width: 3 },
               symbol: 'circle',
               symbolSize: 8,
               animationDuration: 2400,
               animationEasing: 'cubicOut'
             },
             {
               name: '降价幅度',
               type: 'line',
               yAxisIndex: 1,
               data: medicalData.reduction,
               smooth: true,
               connectNulls: true,
               lineStyle: { width: 3, type: 'dashed' },
               symbol: 'diamond',
               symbolSize: 8,
               animationDuration: 2400,
               animationEasing: 'cubicOut'
             }
           ]
         };
   
         chart.setOption(option);
         window.addEventListener('resize', () => chart.resize());
       }
       // 第七页相关变量
        let page7Initialized = false;
        let bubbleChartInstance = null;

        // 第七页初始化函数
        function initPage7() {
            if (page7Initialized) return;
            
            // 添加渐进显示效果
            const page7Elements = document.querySelectorAll('.page-7 .fade-in-element');
            page7Elements.forEach((element, index) => {
                setTimeout(() => {
                    element.classList.add('show');
                }, index * 200);
            });
            
            // 初始化扑克牌交互
            initPokerCards();
            
            // 延迟加载气泡图
            setTimeout(() => {
                initBubbleChart();
            }, 1500);
            
            page7Initialized = true;
        }

        // 扑克牌交互功能
        function initPokerCards() {
            const pokerCards = document.querySelectorAll('.poker-card');
            
            pokerCards.forEach(card => {
                // 点击翻转功能（移动端友好）
                card.addEventListener('click', function(e) {
                    e.preventDefault();
                    const cardInner = this.querySelector('.card-inner');
                    cardInner.style.transform = 
                        cardInner.style.transform === 'rotateY(180deg)' 
                        ? 'rotateY(0deg)' 
                        : 'rotateY(180deg)';
                });
                
                // 鼠标进入时添加动画类
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-10px)';
                });
                
                // 鼠标离开时移除动画类
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });
            });
            
            // 添加键盘支持
            document.addEventListener('keydown', function(e) {
                if (e.key >= '1' && e.key <= '4') {
                    const cardIndex = parseInt(e.key) - 1;
                    const card = pokerCards[cardIndex];
                    if (card) {
                        const cardInner = card.querySelector('.card-inner');
                        cardInner.style.transform = 
                            cardInner.style.transform === 'rotateY(180deg)' 
                            ? 'rotateY(0deg)' 
                            : 'rotateY(180deg)';
                    }
                }
            });
        }

        // 初始化气泡图
        function initBubbleChart() {
            const chartDom = document.getElementById('bubbleChart');
            if (!chartDom) return;
            
            bubbleChartInstance = echarts.init(chartDom);
            
            // 数据准备
            const years = ['2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024'];
            const categories = ['癌症治疗药物', '罕见病药物', '慢性病管理药物', '其他药物'];
            
            const colors = {
                '癌症治疗药物': '#ed5f5f',
                '罕见病药物': '#53a8e1',
                '慢性病管理药物': '#ffa74f',
                '其他药物': '#9a72c7'
            };
            
            const data = {
                '癌症治疗药物': [18, 17, 21, 18, 23, 24, 21, 26],
                '罕见病药物': [5, 0, 13, 10, 7, 7, 15, 13],
                '慢性病管理药物': [8, 0, 25, 38, 42, 52, 35, 19],
                '其他药物': [5, 0, 38, 53, 22, 38, 50, 31]
            };
            
            // 转换数据格式
            const series = [];
            Object.keys(data).forEach((category, categoryIndex) => {
                const seriesData = data[category].map((value, yearIndex) => {
                    return [yearIndex, categoryIndex, value];
                });
                
                series.push({
                    name: category,
                    type: 'scatter',
                    symbolSize: function (val) {
                        return Math.max(15, Math.min(80, val[2] * 1.5));
                    },
                    data: seriesData,
                    itemStyle: {
                        color: colors[category],
                        opacity: 0.8
                    },
                    emphasis: {
                        itemStyle: {
                            opacity: 1,
                            shadowBlur: 20,
                            shadowColor: 'rgba(0, 0, 0, 0.3)'
                        },
                        label: {
                            show: true,
                            formatter: function(param) {
                                return param.value[2] + '种';
                            },
                            position: 'top',
                            fontSize: 14,
                            fontWeight: 'bold'
                        }
                    },
                    animationDelay: function (idx) {
                        return idx * 50;
                    }
                });
            });
            
            const option = {
                backgroundColor: 'transparent',
                title: {
                    show: false
                },
                legend: {
                    data: categories,
                    top: '5%',
                    itemGap: 20,
                    textStyle: {
                        fontSize: 14,
                        color: '#333'
                    },
                    icon: 'circle'
                },
                grid: {
                    left: '5%',
                    right: '5%',
                    bottom: '10%',
                    top: '15%',
                    containLabel: true
                },
                tooltip: {
                    trigger: 'item',
                    formatter: function (params) {
                        return `<div style="padding: 10px;">
                            <strong>${params.seriesName}</strong><br/>
                            年份：${years[params.value[0]]}<br/>
                            数量：<strong style="color: ${colors[params.seriesName]}">${params.value[2]} 种</strong>
                        </div>`;
                    },
                    backgroundColor: 'rgba(255, 255, 255, 0.95)',
                    borderColor: '#ddd',
                    borderWidth: 1,
                    textStyle: {
                        color: '#333'
                    },
                    extraCssText: 'box-shadow: 0 4px 12px rgba(0,0,0,0.15);'
                },
                xAxis: {
                    type: 'category',
                    data: years,
                    boundaryGap: true,
                    splitLine: {
                        show: false
                    },
                    axisLine: {
                        lineStyle: {
                            color: '#ccc'
                        }
                    },
                    axisLabel: {
                        fontSize: 12,
                        color: '#666',
                        interval: 0
                    }
                },
                yAxis: {
                    type: 'category',
                    data: categories,
                    boundaryGap: true,
                    splitLine: {
                        show: true,
                        lineStyle: {
                            type: 'dashed',
                            color: '#e8e8e8'
                        }
                    },
                    axisLine: {
                        lineStyle: {
                            color: '#ccc'
                        }
                    },
                    axisLabel: {
                        fontSize: 12,
                        color: '#666'
                    }
                },
                series: series,
                animationEasing: 'elasticOut',
                animationDuration: 2000
            };
            
            bubbleChartInstance.setOption(option);
            
            // 响应式调整
            window.addEventListener('resize', () => {
                if (bubbleChartInstance) {
                    bubbleChartInstance.resize();
                }
            });
            
            // 添加交互效果
            bubbleChartInstance.on('click', function(params) {
                highlightCategory(params.seriesName);
            });
        }

        // 高亮对应类别的统计段落
        function highlightCategory(category) {
            const categoryMap = {
                '癌症治疗药物': 'cancer',
                '慢性病管理药物': 'chronic',
                '罕见病药物': 'rare',
                '其他药物': 'other'
            };
            
            const targetCategory = categoryMap[category];
            if (!targetCategory) return;
            
            // 高亮对应的扑克牌
            const targetCard = document.querySelector(`.poker-card[data-category="${targetCategory}"]`);
            if (targetCard) {
                targetCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // 添加闪烁效果
                targetCard.classList.add('highlight-flash');
                setTimeout(() => {
                    targetCard.classList.remove('highlight-flash');
                }, 2000);
            }
            
            // 高亮对应的统计段落
            const targetParagraph = document.querySelector(`.stat-paragraph[data-category="${targetCategory}"]`);
            if (targetParagraph) {
                targetParagraph.style.background = 'linear-gradient(135deg, #fff5f5, #fff)';
                targetParagraph.style.transform = 'scale(1.02)';
                
                setTimeout(() => {
                    targetParagraph.style.background = '';
                    targetParagraph.style.transform = '';
                }, 2000);
            }
        }

        // 添加第七页的滚动监听
        window.addEventListener('scroll', function() {
            const page7 = document.getElementById('page7');
            if (!page7) return;
            
            const page7Top = page7.offsetTop;
            const scrollTop = window.pageYOffset;
            const windowHeight = window.innerHeight;
            
            // 当滚动到第七页时初始化
            if (scrollTop > page7Top - windowHeight * 0.8 && !page7Initialized) {
                initPage7();
            }
        });

        // 添加闪烁动画样式
        const style = document.createElement('style');
        style.textContent = `
            @keyframes highlightFlash {
                0%, 100% { 
                    transform: scale(1);
                    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
                }
                50% { 
                    transform: scale(1.05);
                    box-shadow: 0 15px 40px rgba(255, 140, 0, 0.4);
                }
            }
            
            .poker-card.highlight-flash {
                animation: highlightFlash 0.6s ease-in-out 3;
            }
        `;
        document.head.appendChild(style);

        // 添加触摸支持（移动端）
        if ('ontouchstart' in window) {
            document.querySelectorAll('.poker-card').forEach(card => {
                let touchStartX = 0;
                let touchEndX = 0;
                
                card.addEventListener('touchstart', function(e) {
                    touchStartX = e.changedTouches[0].screenX;
                });
                
                card.addEventListener('touchend', function(e) {
                    touchEndX = e.changedTouches[0].screenX;
                    
                    // 如果是轻触而非滑动，则翻转卡片
                    if (Math.abs(touchEndX - touchStartX) < 50) {
                        const cardInner = this.querySelector('.card-inner');
                        cardInner.style.transform = 
                            cardInner.style.transform === 'rotateY(180deg)' 
                            ? 'rotateY(0deg)' 
                            : 'rotateY(180deg)';
                    }
                });
            });
        }

        // 调试函数
        function debugPage7() {
            console.log('第七页调试信息：');
            console.log('- 初始化状态:', page7Initialized);
            console.log('- 扑克牌数量:', document.querySelectorAll('.poker-card').length);
            console.log('- 气泡图实例:', bubbleChartInstance);
            
            // 手动触发初始化
            initPage7();
        }
        

        const observerOptions = {
    threshold: 0.3,
    rootMargin: '0px 0px -100px 0px'
  };
  const scrollObserver = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('show');
      }
    });
  }, observerOptions);

  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('[data-scroll]').forEach(el => scrollObserver.observe(el));
    // 先触发标题和副标题
    setTimeout(() => {
      document.querySelector('[data-scroll="title"]').classList.add('show');
      setTimeout(() => {
        document.querySelector('[data-scroll="subtitle"]').classList.add('show');
      }, 300);
    }, 500);
  });

  // —— 2. ECharts 舆情动态 初始化 —— 
  function initChart() {
    console.log('开始初始化图表...');
    
    const chartDom = document.getElementById('main');
    if (!chartDom) {
        console.error('找不到图表容器 #main');
        return;
    }
    
    // 确保容器有高度
    if (chartDom.offsetHeight === 0) {
        console.warn('图表容器高度为0，设置默认高度');
        chartDom.style.height = '800px';
    }
    
    const myChart = echarts.init(chartDom);
    
    console.log('ECharts实例创建成功');
    const updateFrequency = 4000;
    const emotionColors = {
      '积极支持': '#53a8e1',
      '理性认可': '#afd3e7',
      '感恩情绪': '#fdcd8c',
      '担忧质疑': '#fca3a3',
      '不满抱怨': '#ed5f5f',
      '愤怒反对': '#ffa74f',
      '中性表达': '#d0bbdb'
    };

    // —— 完整 21 个时期的数据 —— 
    const timelineData = [
      { time: '2018年谈判前', data: [
          { emotion: '中性表达', percentage: 70.7 },
          { emotion: '积极支持', percentage: 14.7 },
          { emotion: '理性认可', percentage: 10.3 },
          { emotion: '感恩情绪', percentage: 2.8  },
          { emotion: '不满抱怨', percentage: 1.1  },
          { emotion: '担忧质疑', percentage: 0.4  },
          { emotion: '愤怒反对', percentage: 0.0  }
        ]
      },
      { time: '2018年谈判期间', data: [
          { emotion: '积极支持', percentage: 46.6 },
          { emotion: '中性表达', percentage: 45.4 },
          { emotion: '理性认可', percentage: 3.5  },
          { emotion: '感恩情绪', percentage: 3.5  },
          { emotion: '担忧质疑', percentage: 0.8  },
          { emotion: '不满抱怨', percentage: 0.1  },
          { emotion: '愤怒反对', percentage: 0.1  }
        ]
      },
      { time: '2018年谈判后', data: [
          { emotion: '中性表达', percentage: 70.1 },
          { emotion: '积极支持', percentage: 26.1 },
          { emotion: '理性认可', percentage: 2.9  },
          { emotion: '感恩情绪', percentage: 0.8  },
          { emotion: '担忧质疑', percentage: 0.2  },
          { emotion: '不满抱怨', percentage: 0.0  },
          { emotion: '愤怒反对', percentage: 0.0  }
        ]
      },
      { time: '2019年谈判前', data: [
          { emotion: '中性表达', percentage: 88.8 },
          { emotion: '理性认可', percentage: 4.2  },
          { emotion: '积极支持', percentage: 3.8  },
          { emotion: '感恩情绪', percentage: 1.4  },
          { emotion: '愤怒反对', percentage: 1.0  },
          { emotion: '担忧质疑', percentage: 0.7  },
          { emotion: '不满抱怨', percentage: 0.1  }
        ]
      },
      { time: '2019年谈判期间', data: [
          { emotion: '中性表达', percentage: 84.6 },
          { emotion: '积极支持', percentage: 8.3  },
          { emotion: '理性认可', percentage: 6.7  },
          { emotion: '感恩情绪', percentage: 0.4  },
          { emotion: '担忧质疑', percentage: 0.0  },
          { emotion: '不满抱怨', percentage: 0.0  },
          { emotion: '愤怒反对', percentage: 0.0  }
        ]
      },
      { time: '2019年谈判后', data: [
          { emotion: '中性表达', percentage: 57.2 },
          { emotion: '积极支持', percentage: 33.0 },
          { emotion: '理性认可', percentage: 5.5  },
          { emotion: '感恩情绪', percentage: 3.6  },
          { emotion: '担忧质疑', percentage: 0.6  },
          { emotion: '不满抱怨', percentage: 0.1  },
          { emotion: '愤怒反对', percentage: 0.1  }
        ]
      },
      { time: '2020年谈判前', data: [
          { emotion: '中性表达', percentage: 57.8 },
          { emotion: '积极支持', percentage: 25.4 },
          { emotion: '理性认可', percentage: 13.3 },
          { emotion: '担忧质疑', percentage: 3.4  },
          { emotion: '愤怒反对', percentage: 0.2  },
          { emotion: '感恩情绪', percentage: 0.0  },
          { emotion: '不满抱怨', percentage: 0.0  }
        ]
      },
      { time: '2020年谈判期间', data: [
          { emotion: '中性表达', percentage: 64.6 },
          { emotion: '积极支持', percentage: 24.2 },
          { emotion: '理性认可', percentage: 8.8  },
          { emotion: '感恩情绪', percentage: 1.0  },
          { emotion: '担忧质疑', percentage: 1.0  },
          { emotion: '不满抱怨', percentage: 0.3  },
          { emotion: '愤怒反对', percentage: 0.0  }
        ]
      },
      { time: '2020年谈判后', data: [
          { emotion: '积极支持', percentage: 51.0 },
          { emotion: '中性表达', percentage: 41.8 },
          { emotion: '理性认可', percentage: 4.1  },
          { emotion: '担忧质疑', percentage: 2.5  },
          { emotion: '感恩情绪', percentage: 0.5  },
          { emotion: '愤怒反对', percentage: 0.1  },
          { emotion: '不满抱怨', percentage: 0.0  }
        ]
      },
      { time: '2021年谈判前', data: [
          { emotion: '中性表达', percentage: 64.5 },
          { emotion: '积极支持', percentage: 24.4 },
          { emotion: '理性认可', percentage: 10.0 },
          { emotion: '担忧质疑', percentage: 0.6  },
          { emotion: '感恩情绪', percentage: 0.2  },
          { emotion: '愤怒反对', percentage: 0.2  },
          { emotion: '不满抱怨', percentage: 0.0  }
        ]
      },
      { time: '2021年谈判期间', data: [
          { emotion: '中性表达', percentage: 64.2 },
          { emotion: '积极支持', percentage: 25.6 },
          { emotion: '理性认可', percentage: 7.8  },
          { emotion: '担忧质疑', percentage: 1.3  },
          { emotion: '感恩情绪', percentage: 0.8  },
          { emotion: '不满抱怨', percentage: 0.3  },
          { emotion: '愤怒反对', percentage: 0.0  }
        ]
      },
      { time: '2021年谈判后', data: [
          { emotion: '中性表达', percentage: 43.3 },
          { emotion: '积极支持', percentage: 34.6 },
          { emotion: '理性认可', percentage: 11.7 },
          { emotion: '感恩情绪', percentage: 9.3  },
          { emotion: '担忧质疑', percentage: 0.9  },
          { emotion: '不满抱怨', percentage: 0.2  },
          { emotion: '愤怒反对', percentage: 0.0  }
        ]
      },
      { time: '2022年谈判前', data: [
          { emotion: '理性认可', percentage: 37.7 },
          { emotion: '中性表达', percentage: 31.7 },
          { emotion: '积极支持', percentage: 20.9 },
          { emotion: '担忧质疑', percentage: 5.8  },
          { emotion: '感恩情绪', percentage: 3.1  },
          { emotion: '不满抱怨', percentage: 0.8  },
          { emotion: '愤怒反对', percentage: 0.0  }
        ]
      },
      { time: '2022年谈判期间', data: [
          { emotion: '中性表达', percentage: 56.9 },
          { emotion: '理性认可', percentage: 21.0 },
          { emotion: '积极支持', percentage: 10.6 },
          { emotion: '担忧质疑', percentage: 6.3  },
          { emotion: '不满抱怨', percentage: 2.4  },
          { emotion: '愤怒反对', percentage: 2.0  },
          { emotion: '感恩情绪', percentage: 0.8  }
        ]
      },
      { time: '2022年谈判后', data: [
          { emotion: '中性表达', percentage: 53.7 },
          { emotion: '理性认可', percentage: 20.6 },
          { emotion: '担忧质疑', percentage: 12.7 },
          { emotion: '积极支持', percentage: 9.1  },
          { emotion: '感恩情绪', percentage: 1.9  },
          { emotion: '不满抱怨', percentage: 1.2  },
          { emotion: '愤怒反对', percentage: 0.8  }
        ]
      },
      { time: '2023年谈判前', data: [
          { emotion: '中性表达', percentage: 45.8 },
          { emotion: '理性认可', percentage: 31.5 },
          { emotion: '积极支持', percentage: 10.2 },
          { emotion: '担忧质疑', percentage: 9.7  },
          { emotion: '愤怒反对', percentage: 1.9  },
          { emotion: '感恩情绪', percentage: 0.5  },
          { emotion: '不满抱怨', percentage: 0.4  }
        ]
      },
      { time: '2023年谈判期间', data: [
          { emotion: '中性表达', percentage: 81.0 },
          { emotion: '理性认可', percentage: 7.4  },
          { emotion: '积极支持', percentage: 7.1  },
          { emotion: '担忧质疑', percentage: 4.0  },
          { emotion: '感恩情绪', percentage: 0.3  },
          { emotion: '愤怒反对', percentage: 0.3  },
          { emotion: '不满抱怨', percentage: 0.0  }
        ]
      },
      { time: '2023年谈判后', data: [
          { emotion: '中性表达', percentage: 53.5 },
          { emotion: '理性认可', percentage: 26.1 },
          { emotion: '担忧质疑', percentage: 9.7  },
          { emotion: '积极支持', percentage: 8.7  },
          { emotion: '不满抱怨', percentage: 1.1  },
          { emotion: '愤怒反对', percentage: 0.5  },
          { emotion: '感恩情绪', percentage: 0.4  }
        ]
      },
      { time: '2024年谈判前', data: [
          { emotion: '中性表达', percentage: 42.3 },
          { emotion: '理性认可', percentage: 29.2 },
          { emotion: '积极支持', percentage: 12.7 },
          { emotion: '担忧质疑', percentage: 11.9 },
          { emotion: '感恩情绪', percentage: 2.3  },
          { emotion: '愤怒反对', percentage: 0.9  },
          { emotion: '不满抱怨', percentage: 0.7  }
        ]
      },
      { time: '2024年谈判期间', data: [
          { emotion: '中性表达', percentage: 61.7 },
          { emotion: '积极支持', percentage: 21.1 },
          { emotion: '理性认可', percentage: 8.0  },
          { emotion: '担忧质疑', percentage: 6.6  },
          { emotion: '感恩情绪', percentage: 1.9  },
          { emotion: '愤怒反对', percentage: 0.5  },
          { emotion: '不满抱怨', percentage: 0.2  }
        ]
      },
      { time: '2024年谈判后', data: [
          { emotion: '中性表达', percentage: 47.1 },
          { emotion: '积极支持', percentage: 26.9 },
          { emotion: '理性认可', percentage: 15.6 },
          { emotion: '担忧质疑', percentage: 8.6  },
          { emotion: '不满抱怨', percentage: 0.9  },
          { emotion: '感恩情绪', percentage: 0.7  },
          { emotion: '愤怒反对', percentage: 0.1  }
        ]
      }
    ];

    const option = {
      backgroundColor: 'transparent',
      title: {
        text: '医保谈判微博舆情动态分析 (2018-2024)',
        subtext: '各时期情感态度分布（%）',
        left: 'center', 
        top: 20,
        textStyle: { 
          fontSize: 24, 
          fontWeight: 'bold',
          color: '#333'
        },
        subtextStyle: { 
          fontSize: 16, 
          color: '#666' 
        }
      },
      grid: { 
        top: 120, 
        bottom: 100, 
        left: 150, 
        right: 120,
        containLabel: true
      },
      xAxis: {
        type: 'value',
        max: 'dataMax',
        axisLabel: { 
          formatter: '{value}%', 
          fontSize: 12 
        },
        splitLine: { 
          show: true, 
          lineStyle: { 
            type: 'dashed', 
            color: '#e0e0e0' 
          } 
        }
      },
      yAxis: {
        type: 'category',
        inverse: true,
        data: Object.keys(emotionColors), // 初始设置所有分类
        axisLabel: { 
          fontSize: 14,
          color: '#333'
        },
        axisTick: {
          show: false
        }
      },
      series: [{
        name: '情感分布',
        type: 'bar',
        realtimeSort: true,
        sortSeriesIndex: 0,
        data: [],
        label: {
          show: true,
          position: 'right',
          formatter: '{c}%',
          fontSize: 12,
          fontWeight: 'bold',
          color: '#333'
        },
        itemStyle: {
          borderRadius: [0, 4, 4, 0]
        },
        emphasis: { 
          focus: 'series' 
        },
        animationDuration: 1000,
        animationDurationUpdate: 1000,
        animationEasing: 'cubicInOut',
        animationEasingUpdate: 'cubicInOut'
      }],
      legend: {
        show: true,
        bottom: 20,
        data: Object.keys(emotionColors),
        textStyle: { 
          fontSize: 12 
        },
        itemWidth: 25,
        itemHeight: 14,
        formatter: function(name) {
          return name;
        }
      },
      graphic: {
   elements: [{
     id: 'timeLabel',
     type: 'text',
     right: 80,
     bottom: 120,
     style: {
       text: '',
       fill: 'rgba(100,100,100,0.25)',
       fontSize:   100,        // 直接指定字号
       fontWeight: 'bold',     // 粗体
       fontFamily: 'Arial',    // 字体
       textAlign:  'right'
     },
     z: 100
   }]
 },
      animationDuration: 0,
      animationDurationUpdate: 1000,
      animationEasing: 'linear',
      animationEasingUpdate: 'linear'
    };

    // 设置初始配置
    myChart.setOption(option);
    console.log('初始配置设置完成');

    let currentIndex = 0;
    
    function updateData() {
      const frame = timelineData[currentIndex];
      console.log(`更新数据: ${frame.time}`);
      
      // 准备数据，确保包含所有类别
      const dataMap = {};
      frame.data.forEach(item => {
        dataMap[item.emotion] = item.percentage;
      });
      
      // 为所有情感类别生成数据
      const completeData = Object.keys(emotionColors).map(emotion => ({
        name: emotion,
        value: dataMap[emotion] || 0,
        itemStyle: {
          color: emotionColors[emotion]
        }
      }));

      // 更新图表
      myChart.setOption({
        yAxis: {
          data: Object.keys(emotionColors) // 确保y轴显示所有类别
        },
        series: [{
          data: completeData
        }],
        graphic: {
          elements: [{
            id: 'timeLabel',
            style: {
              text: frame.time
            }
          }]
        }
      });

      currentIndex = (currentIndex + 1) % timelineData.length;
    }

    // 立即显示第一帧
    setTimeout(() => {
      updateData();
    }, 100);
    
    // 设置定时更新
    let playInterval = setInterval(updateData, updateFrequency);

    // 点击暂停/继续
    let playing = true;
    myChart.on('click', function(params) {
      // 只在点击图表区域时暂停
      if (params.componentType === 'series') {
        if (playing) {
          clearInterval(playInterval);
          console.log('动画已暂停');
        } else {
          playInterval = setInterval(updateData, updateFrequency);
          console.log('动画已继续');
        }
        playing = !playing;
      }
    });

    // 响应式调整
    window.addEventListener('resize', () => {
      myChart.resize();
    });
    
    // 确保图表在可见时重新渲染
    const resizeObserver = new ResizeObserver(entries => {
      for (let entry of entries) {
        if (entry.target === chartDom) {
          myChart.resize();
        }
      }
    });
    resizeObserver.observe(chartDom);
    
    console.log('图表初始化完成');
}

// 添加调试函数
function debugChart() {
    const chartDom = document.getElementById('main');
    console.log('=== 图表调试信息 ===');
    console.log('图表容器:', chartDom);
    console.log('容器尺寸:', chartDom ? `${chartDom.offsetWidth}x${chartDom.offsetHeight}` : '未找到');
    console.log('ECharts版本:', typeof echarts !== 'undefined' ? echarts.version : '未加载');
    
    // 检查容器的CSS
    if (chartDom) {
        const styles = window.getComputedStyle(chartDom);
        console.log('容器样式:');
        console.log('- display:', styles.display);
        console.log('- width:', styles.width);
        console.log('- height:', styles.height);
        console.log('- visibility:', styles.visibility);
    }
}

// 确保在合适的时机初始化
document.addEventListener('DOMContentLoaded', function() {
    // 添加调试
    debugChart();
    initChart();

});




  // ——— 完整“代码1”逻辑 ———
  (function() {
    // 原始数据
    const rawData = [
    ["医保", "谈判", 17311], ["医保", "收起", 12262], ["医保", "药品", 12105],
            ["医保", "国家", 12096], ["收起", "谈判", 12088], ["药品", "谈判", 12041],
            ["国家", "谈判", 12007], ["国家", "药品", 9889], ["国家", "收起", 9618],
            ["医保", "目录", 9615], ["目录", "谈判", 9573], ["收起", "药品", 9377],
            ["目录", "药品", 8581], ["国家", "目录", 8340], ["收起", "目录", 7631],
            ["医保", "纳入", 6485], ["纳入", "谈判", 6439], ["价格", "医保", 5895],
            ["价格", "谈判", 5866], ["纳入", "药品", 5460], ["国家", "纳入", 5263],
            ["价格", "收起", 5230], ["收起", "纳入", 5162], ["目录", "纳入", 4915],
            ["价格", "国家", 4853], ["价格", "药品", 4748], ["医保", "微博", 4514],
            ["医保", "视频", 4511], ["微博", "谈判", 4423], ["视频", "谈判", 4422],
            ["医保", "降价", 4343], ["谈判", "降价", 4326], ["医保", "患者", 4316],
            ["患者", "谈判", 4293], ["微博", "视频", 4190], ["准入", "医保", 4183],
            ["准入", "谈判", 4179], ["价格", "目录", 4157], ["微博", "收起", 3940],
            ["收起", "视频", 3902], ["患者", "收起", 3763], ["医保", "通过", 3758],
            ["谈判", "通过", 3739], ["国家", "患者", 3727], ["医保", "调整", 3660],
            ["医保", "治疗", 3632], ["调整", "谈判", 3630], ["药品", "视频", 3622],
            ["微博", "药品", 3594], ["企业", "医保", 3588], ["患者", "药品", 3550],
            ["企业", "谈判", 3536], ["医保", "用药", 3529], ["治疗", "谈判", 3528],
            ["用药", "谈判", 3517], ["国家", "视频", 3466], ["国家", "微博", 3444],
            ["收起", "降价", 3440], ["收起", "治疗", 3433], ["收起", "通过", 3425],
            ["医保", "抗癌药", 3420], ["抗癌药", "谈判", 3394], ["国家", "降价", 3388],
            ["国家", "调整", 3360], ["准入", "药品", 3355], ["准入", "国家", 3331],
            ["收起", "调整", 3324], ["药品", "降价", 3313], ["医保", "进入", 3305],
            ["药品", "调整", 3290], ["医保", "范围", 3274], ["范围", "谈判", 3261],
            ["医保", "新闻", 3240], ["谈判", "进入", 3207], ["收起", "用药", 3196],
            ["国家", "通过", 3175], ["目录", "调整", 3158], ["患者", "目录", 3155],
            ["用药", "药品", 3155], ["新闻", "谈判", 3148], ["企业", "收起", 3124],
            ["药品", "通过", 3123], ["目录", "视频", 3114], ["国家", "用药", 3109],
            ["医保", "医疗", 3107], ["治疗", "药品", 3094], ["微博", "目录", 3093],
            ["医疗", "谈判", 3084], ["其中", "医保", 3076], ["国家", "治疗", 3060],
            ["其中", "谈判", 3058], ["医保", "进行", 3003], ["收起", "进入", 2979],
            ["谈判", "进行", 2973], ["国家", "抗癌药", 2943], ["公布", "医保", 2919],
            ["其中", "收起", 2917], ["公布", "谈判", 2903], ["医保", "支付", 2902],
            ["今年", "医保", 2892], ["医保", "基本", 2890], ["支付", "谈判", 2882],
            ["用药", "目录", 2876], ["今年", "谈判", 2869], ["基本", "谈判", 2864],
            ["范围", "药品", 2810], ["收起", "新闻", 2798], ["专家", "医保", 2798],
            ["医保", "平均", 2796], ["纳入", "范围", 2794], ["平均", "谈判", 2787],
            ["目录", "通过", 2774], ["收起", "进行", 2761], ["企业", "国家", 2760],
            ["其中", "药品", 2750], ["医疗", "收起", 2743], ["医保", "结果", 2716],
            ["医保", "工作", 2707], ["专家", "谈判", 2706], ["结果", "谈判", 2699],
            ["其中", "国家", 2691], ["工作", "谈判", 2685], ["医保", "发布", 2685],
            ["目录", "降价", 2679], ["发布", "谈判", 2660], ["平均", "药品", 2650],
            ["支付", "收起", 2650], ["国家", "进入", 2645], ["医保", "罕见", 2636],
            ["罕见", "谈判", 2629], ["公布", "药品", 2618], ["药品", "进入", 2605],
            ["中国", "医保", 2595], ["准入", "收起", 2592], ["今年", "收起", 2590],
            ["目录", "进入", 2582], ["国家", "范围", 2578], ["医疗", "国家", 2573],
            ["医保", "实施", 2573], ["支付", "药品", 2570], ["医保", "成功", 2566],
            ["基本", "收起", 2557], ["成功", "谈判", 2557], ["实施", "谈判", 2554],
            ["收起", "范围", 2539], ["医保", "新增", 2533], ["新增", "谈判", 2525],
            ["公布", "国家", 2523], ["医保", "新版", 2523], ["企业", "药品", 2521]
    ];

    // 构建节点 & 链接
    const nodes = new Map();
    const links = [];
    rawData.forEach(([s,t,v])=>{
      if(!nodes.has(s)) nodes.set(s,{id:s,weight:0,connections:new Set()});
      if(!nodes.has(t)) nodes.set(t,{id:t,weight:0,connections:new Set()});
      nodes.get(s).weight += v;
      nodes.get(t).weight += v;
      nodes.get(s).connections.add(t);
      nodes.get(t).connections.add(s);
      links.push({source:s,target:t,value:v});
    });
    const nodeArray = Array.from(nodes.values()).sort((a,b)=>b.weight-a.weight);

    // 分类 + 颜色
    function getCategory(id) {
      const cats = {
        "政策核心":["医保","谈判","国家","政策","基本"],
        "药品医疗":["药品","用药","抗癌药","罕见","医药"],
        "经济价格":["价格","降价","支付","费用","成本"],
        "患者群体":["患者","群体","病人","需求","民众"],
        "医药企业":["企业","公司","厂家","生产","研发"],
        "医疗机构":["医疗","医院","机构","卫生","治疗"],
        "正面情绪":["成功","新增","通过","纳入","进入"],
        "负面情绪":["失败","退出","困难","问题","挑战"],
        "中性分析":["目录","调整","范围","收起","其中","发布","公布","结果","工作","进行","实施"],
        "地区相关":["中国","地方","省市","区域","全国"]
      };
      for(let k in cats) if(cats[k].some(w=>id.includes(w))) return k;
      if(["微博","视频","新闻"].includes(id)) return "中性分析";
      return "中性分析";
    }
    const colorMap = {
      "政策核心":"#3b82f6","药品医疗":"#f59e0b","经济价格":"#10b981",
      "患者群体":"#ec4899","医药企业":"#8b5cf6","医疗机构":"#f97316",
      "正面情绪":"#06b6d4","负面情绪":"#ef4444","中性分析":"#6b7280","地区相关":"#84cc16"
    };
    nodeArray.forEach(n=>{
      n.category=getCategory(n.id);
      n.color=colorMap[n.category];
    });

    // SVG 尺寸
    const width=1400, height=800, cx=width/2, cy=height/2, r=Math.min(width,height)*0.35;
    const svg = d3.select("#networkVisualization").append("svg").attr("viewBox",[0,0,width,height]);
    const g = svg.append("g");
    d3.zoom().scaleExtent([0.5,3]).on("zoom",e=>g.attr("transform",e.transform))(svg);
    const tooltip = d3.select(".tooltip");

    // 圆形布局
    function circularLayout() {
      const step=2*Math.PI/nodeArray.length;
      nodeArray.forEach((d,i)=>{
        const a=i*step-Math.PI/2;
        d.x=cx+r*Math.cos(a);
        d.y=cy+r*Math.sin(a);
        d.angle=a;
      });
    }
    circularLayout();

    // 画链接
    const link = g.append("g").selectAll("path").data(links).join("path")
      .attr("class","link")
      .attr("stroke",d=>colorMap[getCategory(d.source)])
      .attr("stroke-width",d=>Math.sqrt(d.value)/50)
      .attr("d",d=>{
        const s=nodeArray.find(n=>n.id===d.source),
              t=nodeArray.find(n=>n.id===d.target),
              dx=t.x-s.x, dy=t.y-s.y, dr=Math.hypot(dx,dy)/2;
        return `M${s.x},${s.y}A${dr},${dr} 0 0,1 ${t.x},${t.y}`;
      });

    // 画节点
    const node = g.append("g").selectAll("g").data(nodeArray).join("g")
      .attr("class","node")
      .attr("transform",d=>`translate(${d.x},${d.y})`)
      .on("mouseenter",(e,d)=>{
        link.classed("fade",l=>l.source!==d.id&&l.target!==d.id)
            .classed("highlight",l=>l.source===d.id||l.target===d.id);
        node.classed("fade",n=>!d.connections.has(n.id)&&n.id!==d.id);
        const cnt=d.connections.size,
              tot=links.filter(l=>l.source===d.id||l.target===d.id).reduce((s,l)=>s+l.value,0);
        const scrollY = window.scrollY || document.documentElement.scrollTop;
        const scrollX = window.scrollX || document.documentElement.scrollLeft;
        tooltip.style("opacity",1)
          .html(`<strong>${d.id}</strong><br>类别: ${d.category}<br>权重: ${d.weight.toLocaleString()}<br>连接数: ${cnt}<br>连接强度: ${tot.toLocaleString()}`)
          .style("left",e.pageX+10+"px")
          .style("top",e.pageY-10+"px");
      })
      .on("mouseleave",()=>{
        link.classed("fade",false).classed("highlight",false);
        node.classed("fade",false);
        tooltip.style("opacity",0);
      });

    node.append("circle").attr("r",d=>Math.sqrt(d.weight)/60+5).attr("fill",d=>d.color);
    node.append("text")
      .text(d=>d.id)
      .attr("x",d=>(Math.sqrt(d.weight)/60+15)*Math.cos(d.angle))
      .attr("y",d=>(Math.sqrt(d.weight)/60+15)*Math.sin(d.angle))
      .style("font-size",d=>Math.min(Math.sqrt(d.weight)/70+10,14)+"px")
      .attr("transform",d=>{
        const deg=d.angle*180/Math.PI+90,
              x=(Math.sqrt(d.weight)/60+15)*Math.cos(d.angle),
              y=(Math.sqrt(d.weight)/60+15)*Math.sin(d.angle);
        return deg>90&&deg<270?`rotate(${deg+180},${x},${y})`:`rotate(${deg},${x},${y})`;
      });

    // 布局切换
    let simulation=null, currentLayout="circular";
    window.changeLayout = function(layout){
      currentLayout=layout;
      if(simulation) simulation.stop();
      if(layout==="circular"){
        circularLayout();
        node.transition().duration(1000).attr("transform",d=>`translate(${d.x},${d.y})`);
        link.transition().duration(1000).attr("d",d=>{
          const s=nodeArray.find(n=>n.id===d.source),
                t=nodeArray.find(n=>n.id===d.target),
                dx=t.x-s.x, dy=t.y-s.y, dr=Math.hypot(dx,dy)/2;
          return `M${s.x},${s.y}A${dr},${dr} 0 0,1 ${t.x},${t.y}`;
        });
      } else {
        simulation = d3.forceSimulation(nodeArray)
          .force("link",d3.forceLink(links).id(d=>d.id).distance(100))
          .force("charge",d3.forceManyBody().strength(-300))
          .force("center",d3.forceCenter(cx,cy))
          .force("collision",d3.forceCollide().radius(d=>Math.sqrt(d.weight)/60+20))
          .on("tick",()=>{
            node.attr("transform",d=>`translate(${d.x},${d.y})`);
            link.attr("d",d=>`M${d.source.x},${d.source.y}L${d.target.x},${d.target.y}`);
          });
      }
    };

    window.resetView = function(){
      svg.transition().duration(750).call(d3.zoom().transform, d3.zoomIdentity);
    };
    window.changeNetworkLayout = window.changeLayout;
  })();





       // 2. 用 IntersectionObserver 监测 page6，滑到时才调用 renderChart()
       const observer = new IntersectionObserver((entries, obs) => {
            entries.forEach(ent => {
                if (ent.isIntersecting) {
                    // 延迟3秒后执行图表动画
                    setTimeout(() => {
                        renderChart();
                    }, 0); // 3000毫秒 = 3秒
                    obs.disconnect(); // 只执行一次
                }
            });
        }, { threshold: 0.9});

        observer.observe(document.getElementById('chart'));
            </script>
         
</body>
</html>